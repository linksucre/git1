<!DOCTYPE html>
<html>

<head>
	<meta charset="UTF-8">
	<title></title>
  
</head>
<link rel="stylesheet" type="text/css" href="css/switchbutton.css">
<link href="images/logo.png" rel="shortcut icon" />
<link rel="import" href="public.html">
<script type="text/javascript" src="js/index_loading.js"></script>
<!-- 百度地图 -->   
<link rel="stylesheet" href="http://api.map.baidu.com/library/DrawingManager/1.4/src/DrawingManager_min.css">
<link href="http://api.map.baidu.com/library/TrafficControl/1.2/src/TrafficControl_min.css" rel="stylesheet" type="text/css">
<!-- // 百度地图 -->
<script type="text/javascript" src="http://api.map.baidu.com/api?v=2.0&ak=h86KsPl6VGvedz2G3CGmR37Ah8oMUMcY"></script>
<script type="text/javascript" src="http://api.map.baidu.com/library/DistanceTool/1.2/src/DistanceTool_min.js"></script>
<script type="text/javascript" src="http://api.map.baidu.com/library/TextIconOverlay/1.2/src/TextIconOverlay_min.js"></script>
<script type="text/javascript" src="http://api.map.baidu.com/library/MarkerClusterer/1.2/src/MarkerClusterer_min.js"></script>
<!-- //加载鼠标绘制工具 -->
<script type="text/javascript" src="http://api.map.baidu.com/library/DrawingManager/1.4/src/DrawingManager_min.js"></script>
<!-- //拉框放大 -->
<script type="text/javascript" src="http://api.map.baidu.com/library/RectangleZoom/1.2/src/RectangleZoom_min.js"></script>
<!-- //交通路况 -->
<script type="text/javascript" src="http://api.map.baidu.com/library/TrafficControl/1.2/src/TrafficControl_min.js"></script>
<script type="text/javascript" src="http://api.map.baidu.com/library/SearchInRectangle/1.2/src/SearchInRectangle_min.js"></script>
<!-- <script src="./js/undomanager.js"></script> -->
<style type="text/css">
	#next {
		width: 32px;
		height: 32px;
		display: inline-block;
		background: url(images/next_btn.png)no-repeat;
	}

	#previous {
		width: 32px;
		height: 32px;
		display: inline-block;
		background: url(images/last_btn.png)no-repeat;
		margin-right: 10px;
	}

	.wind_tab {
		width: 97%;
		height: 120px;
	}

	.wind_tab1 {
		height: 80px;
	}

	.wind_tab tr td {
		border: 1px solid gainsboro;
	}

	.BMap_pop div:nth-child(1) {
		border-radius: 7px 0 0 0;
		box-sizing: border-box;
		padding: 5px 0 0 5px;
	}

	.BMap_pop div:nth-child(3) {
		border-radius: 0 7px 0 0;
	}

	.BMap_pop div:nth-child(3) div:nth-child(1) {
		background: #e0ecff!important;
	}

	.BMap_pop div:nth-child(5) {
		border-radius: 0 0 0 7px;
	}

	.BMap_pop div:nth-child(5) div:nth-child(1) {
		width: 25px!important;
		height: 25px!important;
	}

	.BMap_pop div:nth-child(7) {
		border-radius: 0 0 7px 0;
	}

	.BMap_pop div:nth-child(7) div:nth-child(1) {
		width: 25px!important;
		height: 25px!important;
	}

	.BMap_pop div:nth-child(9) {
		top: 0!important;
		left: 0!important;
		width: 311px!important;
		border-radius: 0 7px 0 0;
	}

	.BMap_pop div:nth-child(9) div:nth-child(1) {
		background: #1296db!important;
		color: #ffffff;
	}

	.BMap_pop .BMap_top {
		background: #e0ecff!important;
	}

	.BMap_pop .BMap_bubble_content {
		box-sizing: border-box;
		padding: 10px 0 0 10px;
	}

	.wind_tab {
		width: 97%;
		height: 120px;
	}

	.wind_tab1 {
		height: 80px;
	}

	.wind_tab tr td {
		border: 1px solid gainsboro;
	}

	.BMap_pop div:nth-child(1) {
		border-radius: 7px 0 0 0;
		box-sizing: border-box;
		padding: 5px 0 0 5px;
	}

	.BMap_pop div:nth-child(3) {
		border-radius: 0 7px 0 0;
	}

	.BMap_pop div:nth-child(3) div:nth-child(1) {
		background: #e0ecff!important;
	}

	.BMap_pop div:nth-child(5) {
		border-radius: 0 0 0 7px;
	}

	.BMap_pop div:nth-child(5) div:nth-child(1) {
		width: 25px!important;
		height: 25px!important;
	}

	.BMap_pop div:nth-child(7) {
		border-radius: 0 0 7px 0;
	}

	.BMap_pop div:nth-child(7) div:nth-child(1) {
		width: 25px!important;
		height: 25px!important;
	}

	.BMap_pop div:nth-child(9) {
		top: 0!important;
		left: 0!important;
		width: 311px!important;
		border-radius: 0 7px 0 0;
	}

	.BMap_pop div:nth-child(9) div:nth-child(1) {
		background: #1296db!important;
		color: #ffffff;
	}

	.BMap_pop .BMap_top {
		background: #e0ecff!important;
	}

	.BMap_pop .BMap_bubble_content {
		box-sizing: border-box;
		padding: 10px 0 0 10px;
	}

	.wind_tab {
		width: 97%;
		height: 120px;
	}

	.wind_tab1 {
		height: 80px;
	}

	.wind_tab tr td {
		border: 1px solid gainsboro;
	}

	.BMap_pop div:nth-child(1) {
		border-radius: 7px 0 0 0;
		box-sizing: border-box;
		padding: 5px 0 0 5px;
	}

	.BMap_pop div:nth-child(3) {
		border-radius: 0 7px 0 0;
	}

	.BMap_pop div:nth-child(3) div:nth-child(1) {
		background: #e0ecff!important;
	}

	.BMap_pop div:nth-child(5) {
		border-radius: 0 0 0 7px;
	}

	.BMap_pop div:nth-child(5) div:nth-child(1) {
		width: 25px!important;
		height: 25px!important;
	}

	.BMap_pop div:nth-child(7) {
		border-radius: 0 0 7px 0;
	}

	.BMap_pop div:nth-child(7) div:nth-child(1) {
		width: 25px!important;
		height: 25px!important;
	}

	.BMap_pop div:nth-child(9) {
		top: 0!important;
		left: 0!important;
		width: 311px!important;
		border-radius: 0 7px 0 0;
	}

	.BMap_pop div:nth-child(9) div:nth-child(1) {
		background: #1296db!important;
		color: #ffffff;
	}

	.BMap_pop .BMap_top {
		background: #e0ecff!important;
	}

	.BMap_pop .BMap_bubble_content {
		box-sizing: border-box;
		padding: 10px 0 0 10px;
	}
</style>

<body class="easyui-layout" id="container" style="overflow:hidden;">
	<div region="west" split="true" title=" " style="width:14%;height:100%;box-sizing: border-box;min-width:250px;">
		<div class="easyui-accordion" data-options="fit:true,border:false">
			<div title="实时监控" data-options="selected:true,iconCls:'jiankong'">
				<div class="VsearchBar" style="box-sizing: border-box;padding-left: 10px;">
					<div class="statusFileDiv">
						<label>
							<input name="v_status" class="v_status" type="radio" value="0" checked="">所有</label>&nbsp;
						<label>
							<input name="v_status" class="v_status" type="radio" value="1">在线</label>&nbsp;
						<label>
							<input name="v_status" class="v_status" type="radio" value="2">行驶</label>&nbsp;
						<span title="设置树显示" class="span-icon icon-treestatus treeShowSet"></span>&nbsp;
						<span title="重置树" class="span-icon icon-treerefsh treeReflshBtn"></span>&nbsp;
					</div>
					<div class="search">
						<input autocomplete="off" class="easyui-combobox monitorSearch" type="text">
						<input type="text" class="combo-text validatebox-text" autocomplete="off" placeholder="请输入车牌号、自编号">
						<span class="combo-clear qingchu" style="display: block;"></span>
					</div>
				</div>
				<div class="easyui-panel">
					<ul id="tree_open" class="easyui-tree" data-options="
									url:'json/index_tree.json',
									method:'get',
									animate:true,
									checkbox:true,
									formatter:function(node){
										var s = node.text;
										if (node.children){
											s += ' <span style=\'color:black\'>(' + node.children.length + ')</span>';
										}
										return s;
									}
								">
					</ul>
				</div>
			</div>
			<div title="重点关注" data-options="iconCls:'guanzhu'">
				<div class="easyui-panel" style="padding:5px;height: 300px;">
					<ul class="easyui-tree" id="tree" data-options="
									url:'json/tree_data2.json',
									method:'get',
									animate:true,
									formatter:function(node){
										var s = node.text;
										if (node.children){
											s += ' <span style=\'color:black\'>(' + node.children.length + ')</span>';
										}
										return s;
									}
								">
					</ul>
				</div>
				<div id="rightclickdiv" class="easyui-menu" style="width: 115px;">
					<div data-options="iconCls:'icon-add',name:'004'">添加组</div>
					<div data-options="iconCls:'icon-add',name:'001'">添加车辆</div>
					<div data-options="iconCls:'icon-edit',name:'002'">修改</div>
					<div data-options="iconCls:'icon-remove',name:'003'">删除</div>
				</div>

			</div>
			<div title="违规报警" data-options="iconCls:'weigui'">
				<ul class="left_menu">
					<li>
						<a href="#" onclick="addPanel('01vehicle_monitoring/1illegal_alarm/alarm_record.html','报警记录')" href="javascript:void(0)">
							<span class="span-icon1"></span>报警记录</a>
					</li>
					<li>
						<a href="#" onclick="addPanel('01vehicle_monitoring/1illegal_alarm/warn_record.html','预警记录')" href="javascript:void(0)">
							<span class="span-icon1"></span>预警记录</a>
					</li>
				</ul>
			</div>
			<div title="指令交互" data-options="iconCls:'jiaohu'">
				<ul class="left_menu">
					<li>
						<a href="#" onclick="addPanel('01vehicle_monitoring/2instruction_interaction/instru_manage.html','指令管理')">
							<span class="span-icon2"></span>指令管理</a>
					</li>
					<li>
						<a href="#" onclick="addPanel('01vehicle_monitoring/2instruction_interaction/car_call.html','车辆点名')">
							<span class="span-icon3"></span>车辆点名</a>
					</li>
					<li>
						<a href="#" onclick="addPanel('01vehicle_monitoring/2instruction_interaction/send_mess.html','短信下发')">
							<span class="span-icon4"></span>短信下发</a>
					</li>
					<li>
						<a href="#" onclick="addPanel('01vehicle_monitoring/2instruction_interaction/state_dete.html','状态检测')">
							<span class="span-icon5"></span>状态检测</a>
					</li>
					<li>
						<a href="#" onclick="addPanel('01vehicle_monitoring/2instruction_interaction/recorder_acq.html','记录仪采集')">
							<span class="span-icon1"></span>记录仪采集</a>
					</li>
					<li>
						<a href="#" onclick="addPanel('01vehicle_monitoring/2instruction_interaction/rollCall.html','定时点名')">
							<span class="span-icon3"></span>定时点名</a>
					</li>
					<li>
						<a href="#" onclick="addPanel('01vehicle_monitoring/2instruction_interaction/camera_timer.html','定时拍照')">
							<span class="span-icon6"></span>定时拍照</a>
					</li>
					<li>
						<a href="#" onclick="addPanel('01vehicle_monitoring/2instruction_interaction/regularListening.html','定时监听')">
							<span class="span-icon7"></span>定时监听</a>
					</li>
					<li>
						<a href="#" onclick="addPanel('01vehicle_monitoring/2instruction_interaction/roll_call.html','点名记录')">
							<span class="span-icon8"></span>点名记录</a>
					</li>
					<li>
						<a href="#" onclick="addPanel('01vehicle_monitoring/2instruction_interaction/listening_record.html','监听记录')">
							<span class="span-icon9"></span>监听记录</a>
					</li>
					<li>
						<a href="#" onclick="addPanel('01vehicle_monitoring/2instruction_interaction/inter_record.html','交互记录')">
							<span class="span-icon10"></span>交互记录</a>
					</li>
				</ul>
			</div>
			<div title="监控管理" data-options="iconCls:'guanli'">
				<ul class="left_menu">
					<li>
						<a href="#" onclick="addPanel('01vehicle_monitoring/3monitoring_manage/photo_manage.html','照片管理')">
							<span class="span-icon11"></span>照片管理</a>
					</li>
					<li>
						<a href="#" onclick="addPanel('01vehicle_monitoring/3monitoring_manage/audio_manage.html','音频管理')">
							<span class="span-icon9"></span>音频管理</a>
					</li>
					<li>
						<a href="#" onclick="addPanel('01vehicle_monitoring/3monitoring_manage/black_manage.html','黑名单管理')">
							<span class="span-icon12"></span>黑名单管理</a>
					</li>
				</ul>
			</div>
			<div title="行驶记录" data-options="iconCls:'jilu'">
				<ul class="left_menu">
					<li>
						<a href="#" onclick="addPanel('01vehicle_monitoring/4travel_record/guijibofang.html','轨迹播放')">
							<span class="span-icon13"></span>轨迹播放</a>
					</li>
					<li>
						<a href="#" onclick="addPanel('01vehicle_monitoring/4travel_record/duopingjiankong.html','多屏监控')">
							<span class="span-icon14"></span>多屏监控</a>
					</li>
				</ul>
			</div>
		</div>

	</div>
	<div region="center" id="mainPanle" style="width:85.8%;height:96.2%;box-sizing: border-box;overflow:hidden;">
		<div id="mainContainer" class="easyui-tabs" fit="true" border="false" style="width:100%;height:100%;overflow:hidden;">
			<div title="主页" style="position: relative; width:100%;height:100%;overflow:hidden;">
				<div id="allmap" style="width:100%;height:100%;"></div>
				<div class="easyui-resizable" data-options="maxHeight:750,minHeight:50" style="box-sizing: border-box; background: #FFFFFF;width:100%;height:200px;position:absolute; bottom:0;left:0;right:0;">
					<div class="tabs_topbox">
						<table border="0" cellspacing="0" cellpadding="0" class="topbox_table">
							<tr>
								<td>
									<span>图例</span>
								</td>
								<td>
									<div>
										<span>监控总数:0</span>
										<a href="#" title="速度大于10千米/小时" class="easyui-tooltip top" style="color: #6DC704;">行驶中:0</a>
										<a href="#" title="速度小于10千米/小时" class="easyui-tooltip top" style="color: #2404C7;">停车:0</a>
										<a href="#" title="车辆连续10分钟没有上传数据" class="easyui-tooltip top" style="color: #777B99;">离线:0</a>
										<span style="color: #C72404;">报警:0</span>
										<span style="color: #868620;">预警:0</span>
										<span style="color: #777B99;">未曾上线:0</span>
									</div>
								</td>
							</tr>
						</table>
						<div class="car_mes">
							<img src="images/map_car_con.png" />
						</div>
					</div>
					<div class="hover_box">
						<div class="hover_top">
							<span>车辆报警</span>
							<span>报警声音开关：
								<i class="i_icon"></i>
							</span>
						</div>
						<ul class="hover_ul">
							<li>
								<p title="平台超速报警(平台)" class="tab_page">2</p>
								<p>平台超速报警(平台)</p>
							</li>
							<li>
								<p title="限时停车报警(平台)" class="tab_page">32</p>
								<p>限时停车报警(平台)</p>
							</li>
							<li>
								<p title="停车超时报警(平台)" class="tab_page">6</p>
								<p>停车超时报警(平台)</p>
							</li>
							<li>
								<p title="疲劳驾驶报警(平台)" class="tab_page">43</p>
								<p>疲劳驾驶报警(平台)</p>
							</li>
							<li>
								<p title="超速报警(终端)" class="tab_page">17</p>
								<p>超速报警(终端)</p>
							</li>
						</ul>

					</div>

					<div class="easyui-tabs" id="tab_easy" style="width:100%;height:500px;overflow:hidden;">
						<div title="实时监控" data-options="iconCls:'icon-s_monitoring'" style="overflow:hidden;">
							<table border="0" cellspacing="0" cellpadding="0" id="table_1" class="clear_box" style="margin-top:10px;">
								<tbody>
									<tr>
										<td>单位：</td>
										<td>
											<select id="cc" class="easyui-combotree" data-options="url:'json/index_tree.json',method:'get',required:false,cascadeCheck:true,onlyLeafCheck:true"
											    style="width:200px;" multiple></select>
										</td>
										<td>车牌号：</td>
										<td>
											<input type="text" class="width" />
										</td>
										<td>SIM卡号：</td>
										<td>
											<input type="text" class="width" />
										</td>
										<td>终端号：</td>
										<td>
											<input type="text" class="width" />
										</td>
										<td>终端类型：</td>
										<td>
											<select class="easyui-combobox">
												<option value="0">华强V36</option>
												<option value="1">华强V37</option>
												<option value="2">易特08</option>
												<option value="3">易特09(部标)</option>
												<option value="4">天琴</option>
												<option value="5">欧亚北斗星V1.0</option>
												<option value="6">欧亚北斗星V2.0</option>
												<option value="7">欧亚北斗星V2.1</option>
											</select>
										</td>
										<td>在线状态：</td>
										<td>
											<select class="easyui-combobox">
												<option value="0">全部</option>
												<option value="1">行驶中</option>
												<option value="2">离线</option>
												<option value="3">停车</option>
												<option value="4">未曾上线</option>
											</select>
										</td>
										<td>
											<span id="search" onclick="refreshbtn('#dg')">查询</span>
										</td>
										<td>
											<span id="clear" onclick="clearSearch('#dg')">清除</span>
										</td>
									</tr>
								</tbody>
							</table>
							<table border="0" cellspacing="0" cellpadding="0" id="table_2">
								<tbody>
									<tr>
										<td title="显示/隐藏过滤条件"></td>
										<td title="清除列表" onclick="deleteRows('#dg')"></td>
										<td>
											<a id="exportExcel1" href="#" title="导出Excel"></a>
										</td>
										<td>
											<input type="checkbox" />
										</td>
										<td>监控车辆是否显示自编号</td>
										<td>
											<input type="checkbox" />
										</td>
										<td>是否显示路况信息</td>
									</tr>
								</tbody>
							</table>
							<table id="dg_data" class="easyui-datagrid" style="width:100%;height:500px;" data-options="singleSelect:false,collapsible:true,url:'json/index_tab_data.json',method:'get'">
								<thead>
									<tr>
										<th data-options="field:'checkbox',width:80,checkbox:true"></th>
										<th data-options="field:'productid',width:100,align:'center'">车号</th>
										<th data-options="field:'listprice',width:80,align:'center'">信息来源</th>
										<th data-options="field:'unitcost',width:80,align:'center'">自编号</th>
										<th data-options="field:'attr1',width:100,align:'center',formatter:myFormatter">在线状态</th>
										<th data-options="field:'status',width:100,align:'center'">在/离线时长</th>
										<th data-options="field:'status',width:100,align:'center'">速度</th>
										<th data-options="field:'status',width:100,align:'center'">数据点类型</th>
										<th data-options="field:'status',width:100,align:'center'">位置</th>
										<th data-options="field:'status',width:100,align:'center'">方向</th>
										<th data-options="field:'status',width:100,align:'center'">ACC状态</th>
										<th data-options="field:'status',width:100,align:'center'">驾驶员行为状态</th>
										<th data-options="field:'status',width:100,align:'center'">终端报警限速</th>
										<th data-options="field:'status',width:100,align:'center'">终端报警限速</th>
										<th data-options="field:'status',width:100,align:'center'">平台报警限速</th>
										<th data-options="field:'status',width:100,align:'center'">平台预警限速</th>
										<th data-options="field:'status',width:100,align:'center'">所属单位</th>
									</tr>
								</thead>
							</table>
						</div>

						<div title="实时报警" data-options="iconCls:'icon-s_police'" style="overflow:hidden;">
							<table class="easyui-datagrid" id="table_3" title="" style="width:100%;height:250px" data-options="singleSelect:true,collapsible:true,url:'json/datagrid_data1.json',method:'get'">
								<thead>
									<tr>
										<th data-options="field:'itemid',width:100,align:'center'">
											<span class="span"></span>
										</th>
										<th data-options="field:'productid',width:140,align:'center'">车号</th>
										<th data-options="field:'listprice',width:140,align:'center'">报警级别</th>
										<th data-options="field:'unitcost',width:140,align:'center'">报警类型</th>
										<th data-options="field:'attr1',width:160,align:'center'">属性</th>
										<th data-options="field:'status',width:140,align:'center'">报警描述</th>
										<th data-options="field:'status',width:140,align:'center'">报警时间</th>
										<th data-options="field:'status',width:140,align:'center'">位置</th>
										<th data-options="field:'status',width:140,align:'center'">速度</th>
										<th data-options="field:'status',width:140,align:'center'">单位</th>
										<th data-options="field:'status',width:140,align:'center'">经度</th>
										<th data-options="field:'status',width:140,align:'center'">纬度</th>
									</tr>
								</thead>
							</table>
						</div>
						<div title="巡查督办" data-options="iconCls:'icon-search',selected:false" style="overflow:hidden;">
							<table class="easyui-datagrid" title="" style="width:100%;height:250px" data-options="singleSelect:true,collapsible:true,url:'json/datagrid_data1.json',method:'get'">
								<thead>
									<tr>
										<th data-options="field:'itemid',width:400,align:'center'">上级平台</th>
										<th data-options="field:'productid',width:400,align:'center'">类型</th>
										<th data-options="field:'listprice',width:400,align:'center'">时间</th>
										<th data-options="field:'unitcost',width:450,align:'center'">内容</th>
									</tr>
								</thead>
							</table>
						</div>
					</div>
				</div>
				<div class="right_box" style="width:30px; position: absolute;top:0px; right:0;">
					<div class="box1">
						<p class="p1"></p>
					</div>
					<div class="box2">
						<a href="#" class="easyui-tooltip"></a>
						<p>0</p>
					</div>
					<div class="box3">
						<p class="easyui-tooltip tool_box" title="报警声音开关" id="open"></p>
						<p class="baojing">报警弹框</p>
					</div>
					<div class="box4">
						<p>夜间行车</p>
					</div>
				</div>
				<div class="box1_float">
					<ul class="box1_ul">
						<li>
							<a href="#" title="点击按钮查询城市路况信息，再次点击隐藏城市路况信息" class="easyui-tooltip" id="cityTraffic">
								<span>
									<img src="images/Query.png" />
								</span>城市路况</a>
						</li>
						<li>
							<a href="#" title="点击后拉框即可查询车辆，再次点击后可退出" class="easyui-tooltip" id="pullBox">
								<span>
									<img src="images/historyExtent.png" />
								</span>实时区域</a>
						</li>
						<li>
							<a href="#" title="点击后拉框即可查询车辆，再次点击后可退出" class="easyui-tooltip" id="historyArea">
								<span>
									<img src="images/historyExtent.png" />
								</span>历史区域</a>
						</li>
						<li>
							<a href="#" title="点击后拉框即可放大地图，再次点击后可退出" class="easyui-tooltip" id="zoomMax">
								<span>
									<img src="images/nav_zoomin.png" />
								</span>拉框放大</a>
						</li>
						<li>
							<a href="#" title="点击后拉框即可缩小地图，再次点击后可退出" class="easyui-tooltip" id="zoomMin">
								<span>
									<img src="images/nav_zoomout.png" />
								</span>拉框缩小</a>
						</li>
						<li>
							<a href="#" title="点击按钮地图缩放到全局范围" class="easyui-tooltip" id="fullextent">
								<span>
									<img src="images/nav_fullextent.png" />
								</span>全局</a>
						</li>
						<li>
							<a href="#" title="点击按钮地图返回上一视图" class="easyui-tooltip" id="preview">
								<span>
									<img src="images/nav_previous.png" />
								</span>前一视图</a>
						</li>
						<li>
							<a href="#" title="点击按钮地图返回下一视图" class="easyui-tooltip" id="nextview">
								<span>
									<img src="images/nav_next.png" />
								</span>后一视图</a>
						</li>
						<li>
							<a href="#" title="点击可进行地图拖拽" class="easyui-tooltip" id="Dragging">
								<span>
									<img src="images/nav_pan.png" />
								</span>平移</a>
						</li>
						<li>
							<a href="#" title="点击可进行距离测量,再次点击后停止距离测量" class="easyui-tooltip" id="distance">
								<span>
									<img src="images/Measure_Distance.png" />
								</span>测距</a>
						</li>
						<li>
							<a href="#" title="点击可进行面积测量,再次点击后停止面积测量" class="easyui-tooltip" id="measureArea">
								<span>
									<img src="images/Measure_Area.png" />
								</span>测面</a>
						</li>
						<li>
							<a href="#" title="点击按钮可弹出查询面板进行业务点、业务线或业务区查询显示" class="easyui-tooltip" id="query">
								<span>
									<img src="images/Query.png" />
								</span>查询</a>
						</li>
						<li>
							<a href="#" title="点击按钮可查询显示业务点，再次点击可隐藏业务点" class="easyui-tooltip" id="business">
								<span>
									<img src="images/Query.png" />
								</span>业务点</a>
						</li>
					</ul>
				</div>

				<div class="box2_float" style="display: none;">
					<div id="toolbar">
						<div class="state">
							<input class="easyui-switchbutton" name="unitState">
						</div>
					</div>
				</div>
				<table border="0" cellspacing="0" cellpadding="0" class="box3_float">
					<tbody>
						<tr>
							<td>显示弹框</td>
							<td>
								<select id="showBoxOrNot">
									<option value="0">是</option>
									<option value="1">否</option>
								</select>
							</td>
							<td>弹框数量</td>
							<td>
								<input type="text" name="showNum" id="showNum" style="width: 30px;" />
							</td>
							<td>报警类型</td>
							<td>
								<input class="easyui-combobox" style="width: 200px;" name="language" data-options="
													url:'json/combobox_data1.json',
													method:'get',
													valueField:'id',
													textField:'text',
													panelHeight:'auto'
											">
							</td>
							<td>
								<input type="button" id="conmitRealTimeBox" value="确定" />
							</td>
						</tr>
					</tbody>
				</table>
				<table border="0" cellspacing="0" cellpadding="0" class="box4_float clear_box">
					<tbody>
						<tr>
							<td>时间设置：</td>
							<td>开始时间</td>
							<td>
								<input id="ss" class="easyui-timespinner" style="width:80px;" data-options="min:'00:00',showSeconds:true" value="00:00:00">
							</td>
							<td>结束时间</td>
							<td>
								<input id="sss" class="easyui-timespinner" style="width:80px;" data-options="min:'00:00',showSeconds:true" value="00:00:00">
							</td>
							<td>
								<button id="clearBtn" onclick="clearSearch()">清除</button>

							</td>
							<td>
								<button id="commitBtn">确定</button>
							</td>
						</tr>
					</tbody>
				</table>

			</div>
		</div>

		<div id="w5" class="easyui-window" title="属性过滤选择" closed="true" minimizable="false" maximizable="false" style="display: none; width:250px;height:247px; top: 73px;left:1094px ;">
			<div class="panel" style="display: block; width: 100%;height: 100%">
				<div style="width: 100%; padding: 5px; overflow: hidden; height: 100%;" title="" class="panel-body panel-body-noheader panel-body-noborder dialog-content">
					<!--form name="queryform"-->
					<div style="position: relative; width: 100% !important; padding-top: 5px;">
						<label for="setquerylayer" style="width: 100px">图层:</label>
						<select id="setquerylayer" style="width: 174px; height: 23px; display: none;" class="easyui-combobox combobox-f combo-f"
						    data-options="editable:false,panelHeight:100">
							<option>业务点</option>
							<option>业务线</option>
							<option>业务区</option>
							<option>查地址</option>
						</select>

					</div>
					<div id="org-combotree" style="position: relative; width: 100% !important; padding-top: 5px; display: block;">
						<label for="setquerylayerOrgCode" style="width: 100px">单位:</label>
						<select id="setquerylayerOrgCode" style="width: 174px; height: 23px; display: none;" class="easyui-combobox combobox-f combo-f"
						    data-options="editable:false,panelHeight:100">
							<option>集团总部机关</option>
							<option>华北电力部</option>
							<option>大庆油田公司</option>
							<option>新疆油田公司</option>
						</select>

					</div>

					<div id="setquerylayerArea" style="position: relative; padding-top: 5px; display: block; width: 100% !important;">
						<div style="position: relative; width: 100% !important; padding-top: 0px;">
							<label for="AREATYPE" style="width: 100px">类型:</label>
							<select id="AREATYPE" style="position: relative; width: 172px; height: 23px; display: none;" class="easyui-combobox combobox-f combo-f"
							    editable="false">
								<option value="1">禁止驶入范围</option>
								<option value="2">禁止驶出范围</option>
								<option value="3">盲区</option>
								<option value="4">风险区</option>
								<option value="5">允许停车范围</option>
								<option value="6">禁止停车范围</option>
								<option value="7">敏感区域</option>
							</select>

						</div>
						<div style="position: relative; width: 100% !important; padding-top: 5px;">
							<label for="areaName" style="width: 100px">名称:</label>
							<input id="areaName" class="easyui-validatebox textbox validatebox-text" style="width: 172px; height: 23px;">
							<br>
						</div>
					</div>

					<div id="search-button" style="position: relative; width: 100% !important; margin-top: 10px; display: block; border: 0;margin-left: -5px;"
					    class="dialog-button">
						<label style="float: left;">过滤查询结果，筛选您想显示的业务内容：</label>
						<br>
						<!-- <label style="float: left;">勾选或取消，控制您想要显示的图层：</label><br /> wxf-->
						<div style="position: relative; width: 100% !important; padding-top: 5px; display: block;">
							<span style="width: 33% !important;display: unset">
								<label for="checkBusinessPoint">业务点</label>
								<input id="checkBusinessPoint" type="checkbox">
							</span>
							<span style="width: 33% !important;">
								<label for="checkBusinessLine">业务线</label>
								<input id="checkBusinessLine" type="checkbox">
							</span>
							<span style="width: 33% !important; padding-right: 20px;display: unset">
								<label for="checkBusinessPolygon">业务区</label>
								<input id="checkBusinessPolygon" type="checkbox">
							</span>
						</div>
						<div id="search1" style="margin-top: 5px; width: 220px; height: 24px; border: solid 2px gray; background: #1C86EE;">
							<div style="display: inline-block; text-align: center; padding-top: 4px; color: white; width: 100%; cursor: pointer;">查&nbsp;&nbsp;&nbsp;&nbsp;询</div>
						</div>
					</div>
				</div>
			</div>
		</div>
		<!-- ------------- -->
		<div id="e" class="easyui-window" title="选择业务点" minimizable="false" maximizable="false" collapsible="false" data-options="modal:true,closed:true,iconCls:'icon-save'"
		    style="width:688px;height:200px;padding:10px; z-index: 9999999;position: relative ">
			<table style="width: 100%">
				<tbody>
					<tr>
						<td>
							<input type="checkbox" name="yewudian" value="1">中石油加油(气)站</td>
						<td>
							<input type="checkbox" name="yewudian" value="2">中石化加油(气)站</td>
						<td>
							<input type="checkbox" name="yewudian" value="3">社会加油(气)站</td>
						<td>
							<input type="checkbox" name="yewudian" value="4">油库</td>
						<td>
							<input type="checkbox" name="yewudian" value="5">炼油厂</td>
					</tr>
					<tr>
						<td>
							<input type="checkbox" name="yewudian" value="6">运输公司总部</td>
						<td>
							<input type="checkbox" name="yewudian" value="7">省分公司</td>
						<td>
							<input type="checkbox" name="yewudian" value="8">配送中心(车队)</td>
						<td>
							<input type="checkbox" name="yewudian" value="9">小车队</td>
						<td>
							<input type="checkbox" name="yewudian" value="10">仓库</td>
					</tr>
					<tr>
						<td>
							<input type="checkbox" name="yewudian" value="11">机构用户</td>
						<td>
							<input type="checkbox" name="yewudian" value="12">停车排队点、装油鹤位、卸油点</td>
						<td>
							<input type="checkbox" name="yewudian" value="13">生产作业点</td>
						<td>
							<input type="checkbox" name="yewudian" value="14">危险源</td>
						<td>
							<input type="checkbox" name="yewudian" value="15">红绿灯</td>
					</tr>
					<tr>
						<td>
							<input type="checkbox" name="yewudian" value="16">机场</td>
						<td>
							<input type="checkbox" name="yewudian" value="17">车辆检测维修厂</td>
						<td>
							<input type="checkbox" name="yewudian" value="18">停车场</td>
						<td>
							<input type="checkbox" name="yewudian" value="19">服务区停车点</td>
						<td>
							<input type="checkbox" name="yewudian" value="20">食宿点</td>
					</tr>
					<tr>
						<td>
							<input type="checkbox" name="yewudian" value="21">路线关键点</td>
						<td>
							<input type="checkbox" name="yewudian" value="22">车库</td>
					</tr>
					<tr>
						<td align="center" colspan="5">
							<input type="button" value="全选" id="selectAll" style="cursor: pointer">
							<input type="button" value="取消全选" id="unselect" style="cursor: pointer">
							<input type="button" onclick="" id="sure" value="确定" style="cursor: pointer">
						</td>
					</tr>
				</tbody>
			</table>
		</div>

	</div>

	<div class="tree_show_set">
		<p>
			<span class="filter"></span>显示车辆状态</p>
		<p>
			<span class="filter"></span>显示终端号</p>
		<p>
			<span class="filter"></span>显示SIM卡号</p>
		<p>
			<span class="filter"></span>显示驾驶员</p>
		<p>
			<span class="filter"></span>显示车辆自编号</p>
	</div>
	<div id="tabsMenu" class="easyui-menu" style="width: 120px; height: 72px; display: none; left: 0px; top: 0px;">
		<div name="close" class="menu-item">关闭</div>
		<div name="Other" class="menu-item">关闭其他</div>
		<div name="All" class="menu-item">关闭全部</div>
	</div>
	<!--模态框 tree 添加车辆 数据-->
	<div id="w" class="easyui-window" closed="true" title="选择车辆" data-options="modal:true,collapsible:false,minimizable:false,maximizable:false,iconCls:'icon-save'"
	    style="width:900px;height:430px;">
		<div style="width:100%;box-sizing: border-box; padding: 5px 0 0 0px">
			<table border="0" cellspacing="0" cellpadding="0" class="table_layout">
				<tr>
					<td>车牌号：</td>
					<td>
						<input type="text" name="number" />
					</td>
					<td>自编号：</td>
					<td>
						<input type="text" />
					</td>
					<td>单位：</td>
					<td>
						<input class="easyui-combotree width" data-options="url:'json/tree_data1.json',method:'get',required:false" style="width:200px;">
					</td>
					<td class="search_add" colspan="3" style="padding-left: 5px;">
						<span onclick="refreshbtn('#dg1')">查询</span>
						<span class="add_tree">添加</span>
					</td>
				</tr>
			</table>
			<table id="dg1" title="" class="easyui-datagrid" style="width:100%;height:320px" data-options="fitColumns:true,rownumbers:true,singleSelect:false,pagination:true,pageList:[5,10,15,20],url:'json/add_tree_data.json',method:'get'">
				<thead>
					<tr>
						<th data-options="field:'checkbox',checkbox:true"></th>
						<th data-options="field:'idNumber'">车牌号</th>
						<th data-options="field:'myCode'">自编号</th>
						<th data-options="field:'pattern'">车辆类型</th>
						<th data-options="field:'orgName'">单位</th>
						<th data-options="field:'TerminalName'">终端编号</th>
						<th data-options="field:'simId'">SIM</th>
						<th data-options="field:'userName'">驾驶员</th>
					</tr>
				</thead>
			</table>
		</div>

	</div>
	<div id="w1" class="easyui-window" closed="true" title="提示框" data-options="modal:true,collapsible:false,minimizable:false,maximizable:false,iconCls:'icon-save'"
	    style="width:300px;height:120px;">
		<div style="width:100%;box-sizing: border-box; padding: 5px 0 0 20px">
			请选择车辆！
		</div>
		<div style="width:100%; text-align: center;margin-top: 10px;">
			<a href="#" class="easyui-linkbutton search_add" onclick="$('#w1').window('close')">确定</a>
		</div>
	</div>
	<div id="tab_w1" class="easyui-window" closed="true" title="提示框" data-options="modal:true,collapsible:false,minimizable:false,maximizable:false,iconCls:'icon-save'"
	    style="width:300px;height:120px;">
		<div style="width:100%;box-sizing: border-box; padding: 5px 0 0 20px">
			请选择在线车辆！
		</div>
		<div style="width:100%; text-align: center;margin-top: 10px;">
			<a href="#" class="easyui-linkbutton search_add" onclick="$('#tab_w1').window('close')">确定</a>
		</div>
	</div>

	<div id="tab_w2" class="easyui-window" closed="true" title="京B1234" data-options="collapsible:false,minimizable:false,maximizable:false,iconCls:'icon-save'"
	    style="width:500px;height:500px;top:30px;left: 70%;">
		<div style="width:100%;height:100%; box-sizing: border-box;overflow: hidden;">
			<div class="easyui-tabs" style="width:100%;height:470px;overflow: hidden;">
				<div title="车辆详情" style="overflow: hidden;">
					<div class="tabs_box" style="width: 100%;height: 220px;">
						<table border="0" cellspacing="0" cellpadding="0" class="window_tab">
							<tr>
								<td>车辆号码：
									<span>京B12345</span>
								</td>
								<td>上报时间：
									<span>17-03-17 14:49:59</span>
								</td>
							</tr>
							<tr>
								<td>车辆状态：
									<span>离线</span>
								</td>
								<td>车辆速度：
									<span>0公里/小时</span>
								</td>
							</tr>
							<tr>
								<td>当前报警：</td>
							</tr>
							<tr>
								<td>所属单位：
									<a href="#">总部机关</a>
								</td>
							</tr>
							<tr>
								<td>位&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;置：
									<span>湖北省恩施土家族苗族自治州恩施市</span>
								</td>
								<td>
									<button class="link_btn">查看更多</button>
								</td>
							</tr>
						</table>
					</div>
					<div class="tabs bottom" style="width: 100%;height:220px;margin: 0;padding: 0;">
						<div class="easyui-tabs" style="width:100%;height:100%;overflow: hidden;">
							<div title="车辆信息">
								<table border="0" cellspacing="0" cellpadding="0" class="window_tab" style="height: 170px;">
									<tr>
										<td>营运性质：</td>
										<td>燃油类型：
											<span>汽油</span>
										</td>
									</tr>
									<tr>
										<td>车辆品牌：</td>
										<td>核定载客人数(人)：</td>
									</tr>
									<tr>
										<td>车型：</td>
									</tr>
									<tr>
										<td>总质量(吨)：</td>
									</tr>
									<tr>
										<td>车辆类型：</td>
										<td>车辆出厂日期：</td>
									</tr>
									<tr>
										<td>车辆识别码：
											<span>JBX12345676654323</span>
										</td>
									</tr>
								</table>
							</div>
							<div title="司机信息">
							</div>
							<div title="设备信息">
							</div>

						</div>
					</div>
				</div>
				<div title="短信">
				</div>
				<div title="拍照">
				</div>
				<div title="录音/监听">
				</div>
				<div title="点名">
				</div>
				<div title="跟踪">
				</div>

			</div>
		</div>
		<!--<div style="width:100%; text-align: center;margin-top: 10px;">
			<a href="#" class="easyui-linkbutton search_add" onclick="$('#w1').window('close')">确定</a>
		</div>-->
	</div>


	<button>dianwo </button>
</body>
<script src="./js/mapTools.js"></script>
<script type="text/javascript">
	function myFormatter(value, row, index) {
		return "<a href='#' class='a_text' onclick='tab_mes()' style='color:blue'>" + value + "</a>";
	}
	$(function () {
		$('#dg_data').datagrid({
			onSelect: function (rowIndex, rowData) {
				var ids = [];
				var rows = $('#dg_data').datagrid('getSelections');
				for (var i = 0; i < rows.length; i++) {
					ids.push(rows[i].attr1);
					console.log(ids)
				}
				var ids_data = jQuery.inArray('离线', ids); //返回值 ：0存在  -1不存在
				if (ids_data == 0) {
					$('#tab_w1').window('open');
				} else if (ids_data == -1) {
					$('#tab_w2').window('open');
				}
			}
		})
	})
	$('.link_btn').click(function () {
		$('#tab_w2').window('close');
		addPanel('illegal_alarm/car_detail.html', '六要素');
	})
	//	声音开关
	$('.i_icon').click(function () {
		if ($('.i_icon').attr('class') == 'i_icon') {
			$('.i_icon').attr('class', 'i_icon1');
		} else if ($('.i_icon1').attr('class') == 'i_icon1') {
			$('.i_icon1').attr('class', 'i_icon');

		}
	})
	$('#open').click(function () {
		if ($('#open').attr('id') == 'open') {
			$('#open').attr('id', 'close');
		} else if ($('#close').attr('id') == 'close') {
			$('#close').attr('id', 'open');
		}

	})
	$('.tab_page').click(function () {
		$('#tab_easy').tabs('select', '巡查督办')
	})

	function changePosition(pos) {
		$('#pp').tooltip({
			position: top
		});
	}
	$(function () {
		$('#tab_easy').find('li').eq(1).mousemove(function () {
			$('.hover_box').show();
		})
		$('#tab_easy').find('li').eq(1).siblings().mousemove(function () {
			$('.hover_box').hide();
		})
	})
	$('.hover_box').mouseleave(function () {
		$(this).hide()
	})
	//子页面中点击按钮关闭左边菜单栏
	function westClose_child() {
		$('#container').layout('collapse', 'west');
	}
	//  主页面
	function guiji() {
		addPanel('xingshijilu/guijibofang.html', '轨迹播放')
	}
	//	<!--tree增删改-->
	$(function () {
		var oldnodename = "";
		$('#tree').tree({
			onLoadSuccess: function (node, data) {},
			onClick: function (node) {
				var id = node.id;
				var text = node.text;
				alert(id + 'll' + text);
			},
			onContextMenu: function (e, node) {
				e.preventDefault();
				var id = node.id;
				var rightbuttonobj = $('#rightclickdiv');
				rightbuttonobj.menu('show', {
					left: e.pageX,
					top: e.pageY
				});
				rightbuttonobj.menu({
					onClick: function (item) {
						if (item.name == '001') {
							$('#w').window('open');
							$('.add_tree').click(function () {
								var rowIndex = $('#dg1').datagrid('getSelected');
								if (rowIndex == null) {
									$('#w1').window('open');
								} else if (rowIndex != null) {
									$('#w').window('close');
									var nodeid = appendnode(node);
									var newnode = $('#tree').tree('find', nodeid);
									$('#tree').tree('beginEdit', newnode.target);
									setCursorPos(nodeid);
									$('#dg1').datagrid("reload");
								}

							})

						} else if (item.name == '002') {
							oldnodename = node.text;
							$('#tree').tree('beginEdit', node.target);
							var nodeid = node.id;
							setCursorPos(nodeid);
						} else if (item.name == '003') {
							$('#tree').tree('remove', node.target);
						} else if (item.name == '004') {
							var nodeid = parentAppend(node);
							var newpar = $('#tree').tree('find', nodeid);
							$('#tree').tree('beginEdit', newpar.target);
							setCursorPos(nodeid);
						}
					}
				});
			},
			onAfterEdit: function (node) {
				$('#tree').tree('update', node);
			},
			onCancelEdit: function (node) {
				//alert("onCancelEdit---");  
			}

		});

	});
	//新增和修改结点名称时自动全选结点名称  
	var setCursorPos = function (nodeid) {
		var parnote = $("div[node-id='" + nodeid + "']");
		var titlespannote = $(parnote).children(".tree-title");
		var titleinput = $(titlespannote).children("input");
		var e1 = titleinput[0];
	}
	// 添加子节点
	function appendnode(node) {
		var nodeid = node.id;
		var newid = nodeid + "qqq";
		$('#tree').tree('append', {
			parent: (node ? node.target : null),
			data: [{
				id: newid,
				text: 'newnode',
				checked: true
			}]
		});
		return newid;
	}
	//  添加父节点
	function parentAppend(node) {
		var nodeid = node.id;
		var newid = nodeid + "qqq";
		$('#tree').tree('append', {
			parent: (node ? node.target : null),
			data: [{
				id: newid,
				text: 'newnode',
				checked: true,
				children: [{
					'id': 111,
					'text': 'newText'
				}]
			}]
		});
		return newid;
	}
	// 添加带有定位的导航控件
	var navigationControl = new BMap.NavigationControl({
		// 靠左上角位置
		anchor: BMAP_ANCHOR_TOP_LEFT,
		// LARGE类型
		type: BMAP_NAVIGATION_CONTROL_LARGE,
	});
	map.addControl(navigationControl);
	map.enableScrollWheelZoom();
	map.centerAndZoom(new BMap.Point(103.23, 35.33), 5);
	//	北京   上海   广州
	var opts = {
		width: 280, // 信息窗口宽度
		height: 210, // 信息窗口高度
		title: "详情", // 信息窗口标题
		enableMessage: true //设置允许信息窗发送短息
	};
	//	添加一级点
	var arr = []; /*一级点的数组*/
	var marker2 = ''; /*一级点*/
	var marker = ''; /*二级点*/
	var arrPoint = []; /*二级点的数组*/
	var $obj = ''; /*信息框table*/
	var len = ''; /*数据的长度*/
	var i = 0;
	var message = []; /*二级点的数组*/
	var str = ''; /*一级点的信息*/
	var st = ''; /*二级点的信息*/
	var mes1 = [];
	var mes2 = [];
	//		tree
	var treeArr = [];
	var treeMess = [];
	var treeMes = '';
	$.ajax({
		type: "get",
		url: "json/map.json",
		success: function (data) {
			var data = data;
			for (var j = 0; j < data.first_point.length; j++) {
				for (var i = 0; i < data.first_point[j].second_point.length; i++) {
					st = "<table border='0' cellspacing='0' cellpadding='0' class='wind_tab'>" +
						"<tr>" +
						"<td>姓名：</td>" +
						"<td>" + data.first_point[j].second_point[i].mes.name + "</td>" +
						"</tr>" +
						"<tr>" +
						"<td>车牌号：</td>" +
						"<td>" + data.first_point[j].second_point[i].mes.number + "</td>" +
						"</tr>" +
						"<tr>" +
						"<td>车型：</td>" +
						"<td>" + data.first_point[j].second_point[i].mes.carType + "</td>" +
						"</tr>" +
						"</table>"
					mes1.push(st)
				}
				var splice = mes1.splice(0, data.first_point[j].second_point.length) /*分割数据*/
				var inner = "<span style='display:block; height:120px;margin-bottom:20px;overflow:hidden;'>" + splice +
					"</span>" +
					"<span style='display:block;text-align:center;'>" +
					"<span id='previous' onclick='previous()'></span>" +
					"<span id='next' onclick='next()'></span>" +
					"</span>"
				var s = inner.replace(/,/g, ''); /*去掉逗号*/
				mes2.push(s)
			}
			for (var i = 0; i < data.first_point.length; i++) {
				var pt = new BMap.Point(data.first_point[i].lng, data.first_point[i].lat); // 创建标注
				var myIcon = new BMap.Icon("images/juhe.png", new BMap.Size(30, 30));
				marker2 = new BMap.Marker(pt, {
					icon: myIcon
				}); // 创建标注
				arr.push(marker2)
				var content1 = mes2[i];
				map.addOverlay(marker2); // 将标注添加到地图中
				marker2.disableMassClear();
				addClickHandler1(content1, marker2);
			}

			$.each(arr, function (i) {
				var index = i
				this.addEventListener("click", function () {
					map.removeOverlay(this);
					zoomMax();
					$('.BMap_pop').hide()
					$('.BMap_shadow').hide()
					for (var i = 0; i < data.first_point[index].second_point.length; i++) {
						marker = new BMap.Marker(new BMap.Point(data.first_point[index].second_point[i].lng, data.first_point[
							index].second_point[i].lat));
						arrPoint.push(marker)
						map.addOverlay(marker);
						str = "<table border='0' cellspacing='0' cellpadding='0' class='wind_tab'>" +
							"<tr>" +
							"<td>姓名：</td>" +
							"<td>" + data.first_point[index].second_point[i].mes.name + "</td>" +
							"</tr>" +
							"<tr>" +
							"<td>车牌号：</td>" +
							"<td>" + data.first_point[index].second_point[i].mes.number + "</td>" +
							"</tr>" +
							"<tr>" +
							"<td>车型：</td>" +
							"<td>" + data.first_point[index].second_point[i].mes.carType + "</td>" +
							"</tr>" +
							"</table>"
						message.push(str)
						var content = message[i];
						addClickHandler(content, marker);
					}
				});
			});
			// 左侧操作车辆树结构
			var overlays = [];
			$("#tree_open").tree({
				onCheck: function (node, checked) {
					//如果操作的是叶子节点
					if ($('#tree_open').tree('isLeaf', node.target) && checked == true) {
						// 创建车辆标记
						map.centerAndZoom(new BMap.Point(parseFloat(node.lng), parseFloat(node.lat)), 12);
						createLabelandMarker(node.text, node.km, parseFloat(node.lng), parseFloat(node.lat))
						// overlays.push(label)
					} else if ($('#tree_open').tree('isLeaf', node.target) && checked == false) {
						for (var i = 0; i < overlays.length; i++) {
							map.removeOverlay(overlays[i]);
						}
					};
					// 如果点击的是节点,而不是叶节点
					if (!$('#tree_open').tree('isLeaf', node.target) && checked == true) {
						var nodes = $('#tree_open').tree('getChildren', node.target);
						// console.log(nodes)
						for (var i = 0; i < nodes.length; i++) {
							if ($('#tree_open').tree('isLeaf', nodes[i].target)) {
								//批量创建车辆标记
								map.centerAndZoom(new BMap.Point(103.23, 35.33), 5);
								createLabelandMarker(nodes[i].text, nodes[i].km, nodes[i].lng, nodes[i].lat)
							}
						}
					} else if (!$('#tree_open').tree('isLeaf', node.target) && checked == false) {
						map.clearOverlays();
					}
				}
			});

			function createLabelandMarker(text, km, lng, lat) {
				var pt = new BMap.Point(parseFloat(lng), parseFloat(lat));
				var myIcon = new BMap.Icon("./images/car-icon.png", new BMap.Size(35, 35));
				var marker2 = new BMap.Marker(pt, {
					icon: myIcon
				}); // 创建标注 

				var label = new BMap.Label(text + '&nbsp;&nbsp;&nbsp;' + km, {
					offset: new BMap.Size(-65, 15),
					position: pt
				});

				label.setStyle({
					width: "120px",
					height: "18px",
					lineHeight: "18px",
					fontWeight: 500,
					color: '#000',
					border: '1px solid #34536b',
					textAlign: "center",
				});
				map.addOverlay(marker2); // 将标注添加到地图中
				map.addOverlay(label); // 将label添加到地图
				// label.addEventListener('click', function () {
				// 	$(this).css('z-index', 99991)
				// })
			}
		}
	})

	////	实时获取地图级别    
	var scrollFunc = function (e) {
		e = e || window.event;
		var u = map.getZoom(); /*地图级别*/
		if (u < 14) { /*当级别小于14时清除二级点显示一级点*/
			for (var i = 0; i < arr.length; i++) {
				map.addOverlay(arr[i]);
			}
			for (var i = 0; i < arrPoint.length; i++) {
				map.removeOverlay(arrPoint[i]);
			}
		} else if (u >= 14) {
			for (var i = 0; i < arr.length; i++) {
				map.removeOverlay(arr[i]);
			}
			map.addOverlay(marker);
		}
	}
	//	/*注册事件*/
	if (document.addEventListener) {
		document.addEventListener('DOMMouseScroll', scrollFunc, false);
	} //W3C
	window.onmousewheel = document.onmousewheel = scrollFunc; //IE/Opera/Chrome
	// 信息框
	// 聚合点信息框
	function addClickHandler1(content1, marker2) {
		marker2.addEventListener("mouseover", function (e) {
			openInfo(content1, e)
			message.length = 0;
		});
	}
	//  marker信息框
	function addClickHandler(content, marker) {
		marker.addEventListener("click", function (e) {
			openInfo(content, e)
		});
	}
	//  tree marker信息框
	function addClickHandler2(content2, treePoint) {
		treePoint.addEventListener("click", function (e) {
			openInfo(content2, e)
		});
	}

	function openInfo(content, e) {
		var p = e.target;
		var point = new BMap.Point(p.getPosition().lng, p.getPosition().lat);
		var infoWindow = new BMap.InfoWindow(content, opts); // 创建信息窗口对象 
		map.openInfoWindow(infoWindow, point); //开启信息窗口
	}
	//定义一个控件类,即function 点击marker点放大地图
	function ZoomControl() {
		// 默认停靠位置和偏移量
		this.defaultAnchor = BMAP_ANCHOR_TOP_LEFT;
		this.defaultOffset = new BMap.Size(10, 10);
	}
	ZoomControl.prototype = new BMap.Control(); // 通过JavaScript的prototype属性继承于BMap.Control
	function zoomMax() {
		map.setZoom(map.getZoom() + 9);
	}

	function zoomMax1() {
		map.setZoom(map.getZoom() + 7);
	}
	var myZoomCtrl = new ZoomControl(); // 创建控件		
	map.addControl(myZoomCtrl); // 添加到地图当中
	//    下一页
	function next() {
		$obj = $('.wind_tab');
		len = $obj.length;
		i++;
		if (i == len) {
			i = 0;
		}
		$obj.stop(true, true).hide().eq(i).fadeIn(600);
		return false;
	}
	//    上一页
	function previous() {
		i--;
		if (i == -1) {
			i = len - 1;
		}
		$obj.stop(true, true).hide().eq(i).fadeIn(600);
		return false;
	}

	//  主页面
	function guiji() {
		addPanel('xingshijilu/guijibofang.html', '轨迹播放')
	}
</script>

</html>