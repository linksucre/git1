<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title>报警量统计</title>
	<link rel="stylesheet" type="text/css" href="../css/icon.css">
	<link rel="stylesheet" type="text/css" href="../css/demo.css">
	<link rel="stylesheet" type="text/css" href="../css/easyui.css">
	<link rel="stylesheet" type="text/css" href="../css/other.css">
	<link rel="stylesheet" type="text/css" href="../css/index.css">
	<!--百度地图-->
	<link rel="stylesheet" href="http://api.map.baidu.com/library/DrawingManager/1.4/src/DrawingManager_min.css">
    <link href="http://api.map.baidu.com/library/TrafficControl/1.2/src/TrafficControl_min.css" rel="stylesheet" type="text/css">

	<script type="text/javascript" src="../js/jquery.min.js"></script>
	
	<script type="text/javascript" src="../js/jquery.easyui.min.js"></script>
	<script type="text/javascript" src="../js/index.js"></script>
	<script type="text/javascript" src="../js/fenye.js"></script>
	<script type="text/javascript" src="../js/fengxian.js"></script>
	<script type="text/javascript" src="../js/echarts.min.js"></script>
	<script type="text/javascript" src="../js/loading.js"></script>
	
   <!-- // 百度地图 -->
	<script type="text/javascript" src="http://api.map.baidu.com/api?v=2.0&ak=h86KsPl6VGvedz2G3CGmR37Ah8oMUMcY"></script>
	<script type="text/javascript" src="http://api.map.baidu.com/library/DistanceTool/1.2/src/DistanceTool_min.js"></script>
	<script type="text/javascript" src="http://api.map.baidu.com/library/TextIconOverlay/1.2/src/TextIconOverlay_min.js"></script>
	<script type="text/javascript" src="http://api.map.baidu.com/library/MarkerClusterer/1.2/src/MarkerClusterer_min.js"></script>
	<!-- //加载鼠标绘制工具 -->
	<script type="text/javascript" src="http://api.map.baidu.com/library/DrawingManager/1.4/src/DrawingManager_min.js"></script>
	<!-- //拉框放大 -->
	<script type="text/javascript" src="http://api.map.baidu.com/library/RectangleZoom/1.2/src/RectangleZoom_min.js"></script>
	<!-- //交通路况 -->
	<script type="text/javascript" src="http://api.map.baidu.com/library/TrafficControl/1.2/src/TrafficControl_min.js"></script>
	<script type="text/javascript" src="http://api.map.baidu.com/library/SearchInRectangle/1.2/src/SearchInRectangle_min.js"></script>
		<style>
			.tool{
			width: 307px;
			height:213px;
			border: 1px solid #D4D4D4;
			border-radius:5px;
			background: #FAFAFA;
			box-shadow: 7px 7px 18px -4px grey;
			
		}
		.tool .tool_top{
			width:100%;
			height: 26px;
			line-height: 26px;
			color: #000000;
			background: url(images/tb_bg.png) repeat-x;
			box-sizing: border-box;
			padding: 0 5px;
		}
		.tool .tool_top span{
			display: inline-block;
			float: right;
			color: #85AADA;
		}
		.tool .tool_div_border{
			width: 100%;
			height: 186px;
			box-sizing: border-box;
			padding: 0 5px;
			background: #F4F4F4;
		}
		.tool .tool_div{
			width: 100%;
			height: 179px;
			box-sizing: border-box;
			padding: 5px 5px 0 5px;
			border: 1px solid #D4D4D4;
			background: #FFFFFF;
		}
		.tool .tool_div .tool_tab{
			width: 100%;
			border-left: 1px dashed #CCCCCC;
		}
		.tool .tool_div .tool_tab tr th{
			height: 30px;
			background:#89BCF1;
			text-align: center;
			border-top: 1px dashed #CCCCCC;
			border-right: 1px dashed #CCCCCC;
		}
		.tool .tool_div .tool_tab tr td{
			height: 30px;
			color: #000000;
			border-bottom: 1px dashed #CCCCCC;
			border-right: 1px dashed #CCCCCC;
			box-sizing: border-box;
			padding-left: 5px;
			
		}
		.parent{
			padding: 0!important;
		}
		#allmap div div:nth-child(2) div:nth-child(4){
			z-index:-500!important;
		}
		</style>
	</head>
<body style="padding: 0;">
	<div class="easyui-layout" style="width:100%;height:100%;">
		<div class="easyui-resizable" data-options="minWidth:50,minHeight:50" style="width:100%;height:50%;border:1px solid #ccc;">
			<div id="allmap" style="width:100%;height:100%;"></div>
		</div>
		<div id="dd" class="easyui-draggable easyui-resizable" data-options="handle:'#mytitle'" style="width:100%;height:50%;border:1px solid #ccc">
			<div class="easyui-tabs" style="width:100%;height:100%;">
				<div title="日(区段)统计" style="width:100%; height:100%;">
					<p class="title" style="height:3%;box-sizing: border-box; padding:14px 0 0 10px;margin: 0px;">当前位置：
					   <a href="#" style="color: dodgerblue;" class="remove">集团公司</a>
				    </p>
	                <table border="0" cellspacing="0" cellpadding="0" class="table_layout">
						<tr>
							<td>单位：</td>
							<td><input id="cc" class="easyui-combotree width" data-options="url:'json/tree_data1.json',method:'get',required:false" style="width:200px;"></td>
							<td>开始日期：</td>
							<td>
								<input id="useDate" class="easyui-datetimebox" editable="false" style="width: 140px; display: none;" comboname="useDate">
							</td>
							<td>结束日期：</td>
							<td>
								<input id="useDate" class="easyui-datetimebox" editable="false" style="width: 140px; display: none;" comboname="useDate">				
							</td>
							<td colspan="6">
								<span class="easyui-linkbutton" iconcls="icon-search" onclick="refreshbtn('.easyui-datagrid')">查询</span>
								<span class="easyui-linkbutton" iconcls="icon-excel"><a id="exportExcel" href="#">导出</a></span>
							</td>
						</tr>
					</table>
					<div class="div-dg0" style="width:100%;height:85%">
						<table id="dg0" class="easyui-datagrid" style="width:100%;height:100%" data-options="singleSelect:false,collapsible:false,rownumbers:true,pagination:true,pageList:[5,10,15,20],url:'json/risk_warn.json',method:'get'">
							<thead>
								<tr>
									<th data-options="field:'ORG_NAME',formatter:myFormatter0,width:270">单位</th>
									<th data-options="field:'TOTAL_SEND',width:260">预警发送总次数</th>
									<th data-options="field:'WEATHER_WARN_COUNT',width:260">天气预警发送次数</th>
									<th data-options="field:'ROAD_WARN_COUNT',width:260">路况预警发送次数</th>
									<th data-options="field:'EQU_WARN_COUNT',width:260">地质灾害发送次数</th>
									<th data-options="field:'SEQ_ROAD_WARN_COUNT',width:260">危险路段发送次数</th>
									<th data-options="field:'DEN_DRIVER_WARN_COUNT',width:260">危险驾驶预警发送次数</th>
								</tr>
							</thead>
						</table>
					</div>
					<div class="div-dg1" style="width:100%;height:85%;display: none;">
						<table id="dg1" class="easyui-datagrid" style="width:100%;height:100%" data-options="singleSelect:false,collapsible:false,rownumbers:true,pagination:true,pageList:[5,10,15,20],url:'json/risk_warn1.json',method:'get'">
							 <thead>
								<tr>
									<th data-options="field:'ORG_NAME',formatter:myFormatter1,width:270">单位</th>
									<th data-options="field:'TOTAL_SEND',width:260">预警发送总次数</th>
									<th data-options="field:'WEATHER_WARN_COUNT',width:260">天气预警发送次数</th>
									<th data-options="field:'ROAD_WARN_COUNT',width:260">路况预警发送次数</th>
									<th data-options="field:'EQU_WARN_COUNT',width:260">地质灾害发送次数</th>
									<th data-options="field:'SEQ_ROAD_WARN_COUNT',width:260">危险路段发送次数</th>
									<th data-options="field:'DEN_DRIVER_WARN_COUNT',width:260">危险驾驶预警发送次数</th>
								</tr>
							</thead>
						</table>
					</div>
					<div class="div-dg2" style="width:100%;height:85%;display: none;">
						<table id="dg2" class="easyui-datagrid" style="width:100%;height:100%" data-options="singleSelect:false,collapsible:false,rownumbers:true,pagination:true,pageList:[5,10,15,20],url:'json/risk_warn2.json',method:'get'">
							 <thead>
								<tr>
									<th data-options="field:'ORG_NAME',formatter:myFormatter2,width:270">单位</th>
									<th data-options="field:'TOTAL_SEND',width:260">预警发送总次数</th>
									<th data-options="field:'WEATHER_WARN_COUNT',width:260">天气预警发送次数</th>
									<th data-options="field:'ROAD_WARN_COUNT',width:260">路况预警发送次数</th>
									<th data-options="field:'EQU_WARN_COUNT',width:260">地质灾害发送次数</th>
									<th data-options="field:'SEQ_ROAD_WARN_COUNT',width:260">危险路段发送次数</th>
									<th data-options="field:'DEN_DRIVER_WARN_COUNT',width:260">危险驾驶预警发送次数</th>
								</tr>
							</thead>
						</table>
					</div>
					<div class="div-dg3" style="width:100%;height:85%;display: none;">
						<table id="dg3" class="easyui-datagrid" style="width:100%;height:100%" data-options="singleSelect:false,collapsible:false,rownumbers:true,pagination:true,pageList:[5,10,15,20],url:'json/risk_warn3.json',method:'get'">
							  <thead>
								<tr>
									<th data-options="field:'ORG_NAME',width:270">单位</th>
									<th data-options="field:'TOTAL_SEND',width:260">预警发送总次数</th>
									<th data-options="field:'WEATHER_WARN_COUNT',width:260">天气预警发送次数</th>
									<th data-options="field:'ROAD_WARN_COUNT',width:260">路况预警发送次数</th>
									<th data-options="field:'EQU_WARN_COUNT',width:260">地质灾害发送次数</th>
									<th data-options="field:'SEQ_ROAD_WARN_COUNT',width:260">危险路段发送次数</th>
									<th data-options="field:'DEN_DRIVER_WARN_COUNT',width:260">危险驾驶预警发送次数</th>
								</tr>
							</thead>
						</table>
					</div>
	            </div>
				<div title="月统计" style="width: 100%; height: 100%;">
	                <p class="title_mouth" style="height:3%;box-sizing: border-box; padding:14px 0 0 10px;margin: 0px;">当前位置：
					   <a href="#" style="color: dodgerblue;" class="remove_mouth">集团公司</a>
				    </p>
	                <table border="0" cellspacing="0" cellpadding="0" class="table_layout">
						<tr>
							<td>单位：</td>
							<td><input id="cc" class="easyui-combotree width" data-options="url:'json/tree_data1.json',method:'get',required:false" style="width:200px;"></td>
							<td>年份：</td>
							<td>
							    <select class="easyui-combobox select">
									<option value="">2014</option>
									<option value="">2015</option>
									<option value="">2016</option>
									<option value="">2017</option>
								</select>
							</td>
							<td>月份：</td>
							<td>
								<select class="easyui-combobox select">
									<option value="">01</option>
									<option value="">02</option>
									<option value="">03</option>
									<option value="">04</option>
									<option value="">05</option>
									<option value="">06</option>
									<option value="">07</option>
								</select>
							</td>
							<td colspan="6" class="btn">
								<span onclick="refreshbtn('.easyui-datagrid')">查询</span>
								<span><a id="exportExcel1" href="#">导出</a></span>
							</td>
						</tr>
					</table>
				    <div class="div-dg_mouth0" style="width:100%;height:85%">
						<table id="dg_mouth0" class="easyui-datagrid" style="width:100%;height:100%" data-options="singleSelect:false,collapsible:false,rownumbers:true,pagination:true,pageList:[5,10,15,20],url:'json/risk_warn.json',method:'get'">
							<thead>
								<tr>
									<th data-options="field:'ORG_NAME',formatter:myFormatter_mouth0,width:270">单位</th>
									<th data-options="field:'TOTAL_SEND',width:260">预警发送总次数</th>
									<th data-options="field:'WEATHER_WARN_COUNT',width:260">天气预警发送次数</th>
									<th data-options="field:'ROAD_WARN_COUNT',width:260">路况预警发送次数</th>
									<th data-options="field:'EQU_WARN_COUNT',width:260">地质灾害发送次数</th>
									<th data-options="field:'SEQ_ROAD_WARN_COUNT',width:260">危险路段发送次数</th>
									<th data-options="field:'DEN_DRIVER_WARN_COUNT',width:260">危险驾驶预警发送次数</th>
								</tr>
							</thead>
						</table>
					</div>
					<div class="div-dg_mouth1" style="width:100%;height:85%;display: none;">
						<table id="dg_mouth1" class="easyui-datagrid" style="width:100%;height:100%" data-options="singleSelect:false,collapsible:false,rownumbers:true,pagination:true,pageList:[5,10,15,20],url:'json/risk_warn1.json',method:'get'">
							 <thead>
								<tr>
									<th data-options="field:'ORG_NAME',formatter:myFormatter_mouth1,width:270">单位</th>
									<th data-options="field:'TOTAL_SEND',width:260">预警发送总次数</th>
									<th data-options="field:'WEATHER_WARN_COUNT',width:260">天气预警发送次数</th>
									<th data-options="field:'ROAD_WARN_COUNT',width:260">路况预警发送次数</th>
									<th data-options="field:'EQU_WARN_COUNT',width:260">地质灾害发送次数</th>
									<th data-options="field:'SEQ_ROAD_WARN_COUNT',width:260">危险路段发送次数</th>
									<th data-options="field:'DEN_DRIVER_WARN_COUNT',width:260">危险驾驶预警发送次数</th>
								</tr>
							</thead>
						</table>
					</div>
					<div class="div-dg_mouth2" style="width:100%;height:85%;display: none;">
						<table id="dg_mouth2" class="easyui-datagrid" style="width:100%;height:100%" data-options="singleSelect:false,collapsible:false,rownumbers:true,pagination:true,pageList:[5,10,15,20],url:'json/risk_warn2.json',method:'get'">
							 <thead>
								<tr>
									<th data-options="field:'ORG_NAME',formatter:myFormatter_mouth2,width:270">单位</th>
									<th data-options="field:'TOTAL_SEND',width:260">预警发送总次数</th>
									<th data-options="field:'WEATHER_WARN_COUNT',width:260">天气预警发送次数</th>
									<th data-options="field:'ROAD_WARN_COUNT',width:260">路况预警发送次数</th>
									<th data-options="field:'EQU_WARN_COUNT',width:260">地质灾害发送次数</th>
									<th data-options="field:'SEQ_ROAD_WARN_COUNT',width:260">危险路段发送次数</th>
									<th data-options="field:'DEN_DRIVER_WARN_COUNT',width:260">危险驾驶预警发送次数</th>
								</tr>
							</thead>
						</table>
					</div>
					<div class="div-dg_mouth3" style="width:100%;height:85%;display: none;">
						<table id="dg_mouth3" class="easyui-datagrid" style="width:100%;height:100%" data-options="singleSelect:false,collapsible:false,rownumbers:true,pagination:true,pageList:[5,10,15,20],url:'json/risk_warn3.json',method:'get'">
							  <thead>
								<tr>
									<th data-options="field:'ORG_NAME',width:270">单位</th>
									<th data-options="field:'TOTAL_SEND',width:260">预警发送总次数</th>
									<th data-options="field:'WEATHER_WARN_COUNT',width:260">天气预警发送次数</th>
									<th data-options="field:'ROAD_WARN_COUNT',width:260">路况预警发送次数</th>
									<th data-options="field:'EQU_WARN_COUNT',width:260">地质灾害发送次数</th>
									<th data-options="field:'SEQ_ROAD_WARN_COUNT',width:260">危险路段发送次数</th>
									<th data-options="field:'DEN_DRIVER_WARN_COUNT',width:260">危险驾驶预警发送次数</th>
								</tr>
							</thead>
						</table>
					</div>
				</div>
				<div title="年统计" style="width: 100%; height: 100%;">
                <p class="title_year" style="height:3%;box-sizing: border-box; padding:14px 0 0 10px;margin: 0px;">当前位置：
				   <a href="#" style="color: dodgerblue;" class="remove_year">集团公司</a>
			    </p>
                 <table border="0" cellspacing="0" cellpadding="0" class="table_layout">
					<tr>
						<td>单位：</td>
						<td><input id="cc" class="easyui-combotree width" data-options="url:'json/tree_data1.json',method:'get',required:false" style="width:200px;"></td>
						<td>年份：</td>
						<td>
						    <select class="easyui-combobox select">
								<option value="">2014</option>
								<option value="">2015</option>
								<option value="">2016</option>
								<option value="">2017</option>
							</select>
						</td>
						<td colspan="6" class="btn">
							<span onclick="refreshbtn('.easyui-datagrid')">查询</span>
							<span><a id="exportExcel2" href="#">导出</a></span>
						</td>
					</tr>
				</table>
			     <div class="div-dg_year0" style="width:100%;height:85%">
					<table id="dg_year0" class="easyui-datagrid" style="width:100%;height:100%" data-options="singleSelect:false,collapsible:false,rownumbers:true,pagination:true,pageList:[5,10,15,20],url:'json/risk_warn.json',method:'get'">
						<thead>
							<tr>
								<th data-options="field:'ORG_NAME',formatter:myFormatter_year0,width:270">单位</th>
								<th data-options="field:'TOTAL_SEND',width:260">预警发送总次数</th>
								<th data-options="field:'WEATHER_WARN_COUNT',width:260">天气预警发送次数</th>
								<th data-options="field:'ROAD_WARN_COUNT',width:260">路况预警发送次数</th>
								<th data-options="field:'EQU_WARN_COUNT',width:260">地质灾害发送次数</th>
								<th data-options="field:'SEQ_ROAD_WARN_COUNT',width:260">危险路段发送次数</th>
								<th data-options="field:'DEN_DRIVER_WARN_COUNT',width:260">危险驾驶预警发送次数</th>
							</tr>
						</thead>
					</table>
				</div>
				 <div class="div-dg_year1" style="width:100%;height:85%;display: none;">
					<table id="dg_year1" class="easyui-datagrid" style="width:100%;height:100%" data-options="singleSelect:false,collapsible:false,rownumbers:true,pagination:true,pageList:[5,10,15,20],url:'json/risk_warn1.json',method:'get'">
						 <thead>
							<tr>
								<th data-options="field:'ORG_NAME',formatter:myFormatter_year1,width:270">单位</th>
								<th data-options="field:'TOTAL_SEND',width:260">预警发送总次数</th>
								<th data-options="field:'WEATHER_WARN_COUNT',width:260">天气预警发送次数</th>
								<th data-options="field:'ROAD_WARN_COUNT',width:260">路况预警发送次数</th>
								<th data-options="field:'EQU_WARN_COUNT',width:260">地质灾害发送次数</th>
								<th data-options="field:'SEQ_ROAD_WARN_COUNT',width:260">危险路段发送次数</th>
								<th data-options="field:'DEN_DRIVER_WARN_COUNT',width:260">危险驾驶预警发送次数</th>
							</tr>
						</thead>
					</table>
				</div>
				 <div class="div-dg_year2" style="width:100%;height:85%;display: none;">
					<table id="dg_year2" class="easyui-datagrid" style="width:100%;height:100%" data-options="singleSelect:false,collapsible:false,rownumbers:true,pagination:true,pageList:[5,10,15,20],url:'json/risk_warn2.json',method:'get'">
						 <thead>
							<tr>
								<th data-options="field:'ORG_NAME',formatter:myFormatter_year2,width:270">单位</th>
								<th data-options="field:'TOTAL_SEND',width:260">预警发送总次数</th>
								<th data-options="field:'WEATHER_WARN_COUNT',width:260">天气预警发送次数</th>
								<th data-options="field:'ROAD_WARN_COUNT',width:260">路况预警发送次数</th>
								<th data-options="field:'EQU_WARN_COUNT',width:260">地质灾害发送次数</th>
								<th data-options="field:'SEQ_ROAD_WARN_COUNT',width:260">危险路段发送次数</th>
								<th data-options="field:'DEN_DRIVER_WARN_COUNT',width:260">危险驾驶预警发送次数</th>
							</tr>
						</thead>
					</table>
				</div>
				 <div class="div-dg_year3" style="width:100%;height:85%;display: none;">
					<table id="dg_year3" class="easyui-datagrid" style="width:100%;height:100%" data-options="singleSelect:false,collapsible:false,rownumbers:true,pagination:true,pageList:[5,10,15,20],url:'json/risk_warn3.json',method:'get'">
						  <thead>
							<tr>
								<th data-options="field:'ORG_NAME',width:270">单位</th>
								<th data-options="field:'TOTAL_SEND',width:260">预警发送总次数</th>
								<th data-options="field:'WEATHER_WARN_COUNT',width:260">天气预警发送次数</th>
								<th data-options="field:'ROAD_WARN_COUNT',width:260">路况预警发送次数</th>
								<th data-options="field:'EQU_WARN_COUNT',width:260">地质灾害发送次数</th>
								<th data-options="field:'SEQ_ROAD_WARN_COUNT',width:260">危险路段发送次数</th>
								<th data-options="field:'DEN_DRIVER_WARN_COUNT',width:260">危险驾驶预警发送次数</th>
							</tr>
						</thead>
					</table>
				</div>
			
			</div>
			</div> 
		</div>
		
		<div class="box1_float" style="top: 0;right: 0; display: block;">
			<ul class="box1_ul">
				<li id="zoomMax">
					<a href="#" title="点击后拉框即可放大地图，再次点击后可退出" class="easyui-tooltip"><span><img src="images/nav_zoomin.png"/></span>拉框放大</a>
				</li>
				<li id="zoomMin">
					<a href="#" title="点击后拉框即可缩小地图，再次点击后可退出" class="easyui-tooltip"><span><img src="images/nav_zoomout.png"/></span>拉框缩小</a>
				</li>
				<li id="fullextent">
					<a href="#" title="点击按钮地图缩放到全局范围" class="easyui-tooltip"><span><img src="images/nav_fullextent.png"/></span>全局</a>
				</li>
				<li>
					<a href="#" title="点击按钮地图返回上一视图" class="easyui-tooltip"><span><img src="images/nav_previous.png"/></span>前一视图</a>
				</li>
				<li>
					<a href="#" title="点击按钮地图返回下一视图" class="easyui-tooltip"><span><img src="images/nav_next.png"/></span>后一视图</a>
				</li>
				<li>
					<a href="#" title="点击可进行地图拖拽" class="easyui-tooltip"><span><img src="images/nav_pan.png"/></span>平移</a>
				</li>
				<li id="distance">
					<a href="#" title="点击可进行距离测量,再次点击后停止距离测量" class="easyui-tooltip"><span><img src="images/Measure_Distance.png"/></span>测距</a>
				</li>
				<li id="measureArea">
					<a href="#" title="点击可进行面积测量,再次点击后停止面积测量" class="easyui-tooltip"><span><img src="images/Measure_Area.png"/></span>测面</a>
				</li>
			</ul>
		</div>
	</div>
	
	
	</body>
	<script src="js/mapTools.js"></script>
<script type="text/javascript">
	var map = new BMap.Map("allmap",{enableMapClick:false}); // 创建Map实例
	var point = new BMap.Point(116.404, 39.915); // 创建点坐标
	map.enableScrollWheelZoom(true);     //开启鼠标滚轮缩放
	map.centerAndZoom(point, 6); // 初始化地图,设置中心点坐标和地图级别。
	var divNumber = 1;
	var overlays = [];
	var marker = [];
	var data = [
		{ lng: 121.15,lat:31.89},
	   	{ lng: 109.781327,lat:39.608266},
	   	{ lng: 120.38,lat:37.35}
	]
	var data_message = [
		    {    
		    	"UnitName":"油气田企业",
		    	"monitors":"2",
		    	"LineNumber":"1",
		    	"OnLineRate":"50"
		    },
		    {
		    	"UnitName":"炼化企业",
		    	"monitors":"2",
		    	"LineNumber":"1",
		    	"OnLineRate":"60"
		    },
		    {
		    	
		    	"UnitName":"销售企业",
		    	"monitors":"2",
		    	"LineNumber":"1",
		    	"OnLineRate":"70"
		    }
		]
	var value = [
	{ a: 315,b:310},
   	{ a: 100,b:390},
   	{ a: 120,b:137}
];
console.log(value[0].a)
		// 定义自定义覆盖物的构造函数  
	function SquareOverlay(center, length, color){  	
		 this._center = center; 
		 this._length = length;  
		 this._color = color;  
	}  
// 继承API的BMap.Overlay  
SquareOverlay.prototype = new BMap.Overlay();

// 实现初始化方法  
SquareOverlay.prototype.initialize = function(map){  
	// 保存map对象实例  
	 this._map = map;      
	 // 创建div元素，作为自定义覆盖物的容器  
	 	var div = document.createElement("div");  
		 div.style.position = "absolute";       
		 // 可以根据参数设置元素外观  
		div.id = 'div' + divNumber;
		divNumber++;
		 div.style.width = this._length + "px";  
		 div.style.height = this._length + "px";  
		 div.style.background = this._color;   
		 div.style.borderRadius = '12px';
		 // 将div添加到覆盖物容器中  
		 map.getPanes().markerPane.appendChild(div);    
		 // 保存div实例  
		 this._div = div; 

		  var myChart = echarts.init(document.getElementById(""+div.id+""));	
		function bb(){
			var res ="<div class='tool'>"+
	               "<div class='tool_top'>单位统计信息<span>x</span></div>"+
	               "<div class='tool_div_border'>"+
		               "<div class='tool_div'>"+
		                     "<table border='0' cellspacing='0' cellpadding='0' class='tool_tab'>"+
						    	"<tr>"+
						    		"<th>单位名称</th>"+
						    		"<th>"+data_message[i].UnitName+"</th>"+
						    	"</tr>"+
						    	"<tr>"+
						    		"<td>监控员数量:</td>"+
						    		"<td>"+data_message[i].monitors+"</td>"+
						    	"</tr>"+
						    	"<tr>"+
						    		"<td>上线数量:</td>"+
						    		"<td>"+data_message[i].LineNumber+"</td>"+
						    	"</tr>"+
						    	"<tr>"+
						    		"<td>上线率:</td>"+
						    		"<td>"+data_message[i].OnLineRate+"</td>"+
						    	"</tr>"+
						    "</table>"+
		               "</div>"+
	               "</div>"+
	            "</div>"
	            	return res; 
		}
	// 指定图表的配置项和数据
	option = {
		 tooltip : {
        trigger: 'item',
        	formatter: bb()
    	},
	    series : [
	        {
	           
	            type: 'pie',
	            radius : '55%',
	            center: ['50%', '60%'],
	            data:[
	                {value:""+a+""},
	                {value:""+b+""}
	            ],
	            label: {
	                normal: {
	                    show: false,
	                    position: 'center'
	                }
	            }
	        }
	    ]
	};
	    myChart.setOption(option);
		 // 需要将div元素作为方法的返回值，当调用该覆盖物的show、  
		 // hide方法，或者对覆盖物进行移除时，API都将操作此元素。  
		 $("#" + div.id + "").find('div').eq(1).attr('class','parent');
		 return div;  
	}
   
// 实现绘制方法  
SquareOverlay.prototype.draw = function(){  
// 根据地理坐标转换为像素坐标，并设置给容器 
//			console.log(data[j].lng)
		 var position = this._map.pointToOverlayPixel(this._center);
//		console.log(position)
		 this._div.style.left =position.x - this._length / 2 + "px";  
		 this._div.style.top = position.y - this._length / 2 + "px";  
	
}
SquareOverlay.prototype.show = function(){  
	 if (this._div){  
	   this._div.style.display = ""; 
	
	 }  
} 

	for(var i=0;i<data.length;i++){
		var a = value[i].a
		var b = value[i].b
		var lng = data[i].lng;
		var lat = data[i].lat;
		var poi = new BMap.Point(lng, lat);
		var mySquare = new SquareOverlay(poi, 50, "red");
		map.addOverlay(mySquare);	
		
		
		var UnitName = data_message[i].UnitName;
		var monitors = data_message[i].monitors;
		var LineNumber = data_message[i].LineNumber;
		var OnLineRate = data_message[i].OnLineRate;
		//			添加文本标注
			var point = new BMap.Point(lng, lat);
			var opts = {
			  position : point,  // 指定文本标注所在的地理位置
			  offset : new BMap.Size(-25, 20)    //设置文本偏移量
			}
			var label = new BMap.Label(UnitName, opts);  // 创建文本标注对象
				label.setStyle({
					 color : "#CC6633",
					 fontSize : "12px",
					 height : "20px",
					 lineHeight : "20px",
					 background:'none',
					 border:'none'
				 });
			map.addOverlay(label); 	
			marker.push(mySquare);
	}


	 SquareOverlay.prototype.addEventListener = function(event,fun){
	    this._div['on'+event] = fun;
	}
	$.each(marker, function(data, index) {
			this.addEventListener('click', function() {
			
				$('#allmap').children().children().eq(1).children().eq(3).hide();			
				zoomMax(); //放大地图
				$('#div1').hide();
				$('#div2').hide();
				$('#div3').hide();
				tab_mes();              
				var a_text = $('.a_text').html();
				var a = "<a href='#' class='remove1' onclick='remove1()' style='color: dodgerblue;'>/" + a_text + "</a>";
			   $('.title').append(a);
			})	
		})

//	定义一个控件类,即function 点击marker点放大地图
		function ZoomControl() {
			// 默认停靠位置和偏移量
			this.defaultAnchor = BMAP_ANCHOR_TOP_LEFT;
			this.defaultOffset = new BMap.Size(10, 10);
		}
		ZoomControl.prototype = new BMap.Control();// 通过JavaScript的prototype属性继承于BMap.Control
        function zoomMax(){
          	map.setZoom(map.getZoom() + 5);
         }		
		var myZoomCtrl = new ZoomControl();// 创建控件		
		map.addControl(myZoomCtrl);// 添加到地图当中
//定义一个控件类 点击remove点缩小地图		
		function ZoomControl1() {
			// 默认停靠位置和偏移量
			this.defaultAnchor = BMAP_ANCHOR_TOP_LEFT;
			this.defaultOffset = new BMap.Size(-5, -5);
		}
		ZoomControl1.prototype = new BMap.Control();
        function zoomMin(){
          	map.setZoom(map.getZoom() - 5);
         }		
		var myZoomCtrl1 = new ZoomControl1();
		map.addControl(myZoomCtrl1);
		
		 $('.remove').click(function(){
			zoomMin();//缩小地图
            $('#div1').show();
            $('#div2').show();
            $('#div3').show();
      
		})

</script>
</html>
