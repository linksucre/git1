<!DOCTYPE html>
<html>

<head>
    <meta charset=utf-8 />
    <title>资质管理</title>
    <link rel="import" href="../../public.html">
    <script type="text/javascript" src="../../js/loading.js"></script>
    <script src="../../js/fenye.js"></script>
</head>

<body class="easyui-layout">
    <!--模态框-->
    <div id='w' class="easyui-window" closed='true' title="新增资质" data-options="modal:true,collapsible:false,minimizable:false,maximizable:false,iconCls:'icon-save'"
        style="width:300px;height:390px;">

        <table width="100%" style="margin-bottom:20px">
            <input type="hidden" id="cred_id" name="cred_id" value="">
            <input type="hidden" id="credLTiShi" value="">
            <tbody>
                <tr height="30px" id="JYcredName">
                    <td width="80px">驾驶员姓名：</td>
                    <td>
                        <input type="text" class="easyui-validatebox textbox validatebox-text validatebox-invalid" data-options="required:true" name="credName"
                            id="credName" style="width:100px" readonly="" title="">
                        <!-- 						<input type="button" id="selectDriver" onclick="searchDriverList()" value="请选择" class="easyui-linkbutton"></td></tr> -->
                        <a id="selectDriver" onclick="searchDriverList()" class="easyui-linkbutton l-btn l-btn-small" group="">
                            <span class="l-btn-left">
                                <span class="l-btn-text">请选择</span>
                            </span>
                        </a>
                    </td>
                </tr>
                <input type="hidden" name="driverId" id="driverId" value="">
                <input type="hidden" name="orgCode" id="orgCode" value="">
                <tr height="30px" id="JYcredType">
                    <td>证件类型：</td>
                    <td>
                        <select id="credType" class="easyui-combobox easyui-validatebox combobox-f combo-f validatebox-text" data-options="required:false"
                            style="width: 152px; display: none;" editable="false" comboname="credType">
                            <option value="">驾驶证</option>
                            <option value="">从业资格证</option>
                            <option value="">健康证</option>
                            <option value="">准驾证</option>
                            <option value="">危货运输从业资格证</option>
                        </select>
                    </td>
                </tr>
                <tr id="trCredLvl">
                    <td>证件级别：</td>
                    <td>
                        <select id="credLvl" class="easyui-combobox easyui-validatebox combobox-f combo-f validatebox-text" data-options="required:false"
                            style="width: 152px; display: none;" editable="false" comboname="credLvl">
                            <option value="A1" selected="">A1</option>
                            <option value="A2">A2</option>
                            <option value="A3">A3</option>
                            <option value="B1">B1</option>
                            <option value="B2">B2</option>
                            <option value="C1">C1</option>
                            <option value="C2">C2</option>
                            <option value="C3">C3</option>
                            <option value="C4">C4</option>
                            <option value="D">D</option>
                            <option value="E">E</option>
                            <option value="F">F</option>
                            <option value="M">M</option>
                            <option value="N">N</option>
                            <option value="P">P</option>
                        </select>
                    </td>
                </tr>
                <tr style="display:none" id="trCredCategory">
                    <td>资格类别：</td>
                    <td>
                        <select id="credCategory" class="easyui-combobox easyui-validatebox combobox-f combo-f validatebox-text" data-options="required:true"
                            style="width: 152px; display: none;" editable="false" comboname="credCategory">
                        </select>
                    </td>
                </tr>
                <tr style="display:none" id="tdDangerCategory">
                    <td>危化职位：</td>
                    <td>
                        <select id="dangerCategory" class="easyui-combobox easyui-validatebox combobox-f combo-f validatebox-text" data-options="required:true"
                            style="width: 152px; display: none;" editable="false" comboname="dangerCategory">
                        </select>
                    </td>
                </tr>
                <tr style="display:none" id="trDrivingLicensesInfo">
                    <td>准驾说明：</td>
                    <td>
                        <input type="text" class="easyui-validatebox textbox validatebox-text validatebox-invalid" data-options="required:true" name="drivingLicensesInfo"
                            id="drivingLicensesInfo" placeholder="请填写准驾证信息" style="width:148px">
                    </td>
                </tr>
                <tr id="JYcredLicense">
                    <td>证件号码：</td>
                    <td>
                        <input type="text" name="credLicense" id="credLicense" class="easyui-validatebox textbox validatebox-text validatebox-invalid"
                            data-options="required:true,validType:'idCard'" onblur="selectYesNo()" placeholder="请填写证件号码" style="width:148px"
                            title="">
                    </td>
                </tr>

                <tr id="JYCYcredLicense" style="display:none">
                    <td>证件号码：</td>
                    <td>
                        <input type="text" name="CYcredLicense" id="CYcredLicense" class="easyui-validatebox textbox validatebox-text validatebox-invalid"
                            data-options="required:true,validType:['idNo','length[1,11]'],maxlength: 11" onblur="selectYesNo2()"
                            placeholder="请填写证件号码" style="width:148px">
                    </td>
                </tr>

                <tr id="JYcredcertExpired">
                    <td width="80px">有效期：</td>
                    <td>
                        <input type="text" class="easyui-numberbox easyui-validatebox numberbox numberbox-f validatebox-text" data-options="required:true,min:1,max:10"
                            id="credcertExpired" placeholder="请填写证件有效期（年）" style="width: 146px; height: 20px; line-height: 20px;"
                            numberboxname="credcertExpired" title="">
                        <input type="hidden" name="credcertExpired" value="1">
                    </td>
                </tr>
                <tr height="30px" id="JYcredcertDate">
                    <td>发证日期：</td>
                    <td>
                        <input class="easyui-datebox easyui-validatebox validatebox-text validatebox-invalid datebox-f combo-f" data-options="required:true"
                            id="credcertDate" editable="false" style="width: 152px; display: none;" comboname="credcertDate">
                    </td>
                </tr>
                <tr height="30px" id="JYlicenceExpectDate">
                    <td>截至日期：</td>
                    <td>
                        <input class="easyui-datebox easyui-validatebox validatebox-text validatebox-invalid datebox-f combo-f" data-options="required:true"
                            id="licenceExpectDate" editable="false" style="width: 152px; display: none;" comboname="licenceExpectDate">
                    </td>
                </tr>
                <tr id="JYcredcertInspectDate">
                    <td width="60px">年检日期：</td>
                    <td>
                        <input class="easyui-datebox easyui-validatebox validatebox-text validatebox-invalid datebox-f combo-f" data-options="required:true"
                            id="credcertInspectDate" editable="false" style="width: 152px; display: none;" comboname="credcertInspectDate">
                    </td>
                </tr>
                <tr>
                    <td width="80px">证件图片：</td>
                    <td>
                        <input type="hidden" name="imgUrls" id="imgUrls" readonly="" value="">
                        <input id="upload" type="file" name="upload" style="width:150px;height:23px;"> </td>
                </tr>
            </tbody>
        </table>

        <div id="addCred-button" style="text-align:center;" class="dialog-button">
            <a href="javascript:void(0)" class="easyui-linkbutton" onclick="$('#w').window('close')">确定</a>
            <a href="javascript:void(0)" class="easyui-linkbutton" onclick="$('#w').window('close')">关闭</a>
        </div>
    </div>





    <div id='w1' class="easyui-window" closed='true' title="提示信息" data-options="modal:true,collapsible:false,minimizable:false,maximizable:false,iconCls:'icon-save'"
        style="width:300px;height:150px;">
        <div style="padding: 10px;margin-bottom:15px;">
            选择数据为空，请选择未处理数据！
        </div>

        <div style="text-align:center;padding:5px">
            <a href="javascript:void(0)" class="easyui-linkbutton" onclick="$('#w1').window('close')">确定</a>
        </div>
    </div>
    <div style="width:100%;height:100px;padding-top:15px;box-sizing: border-box;" class="violaBox">
        <table data-options="fit:true" style="border:none" class="table_layout">
            <tbody>
                <tr>
                    <td>驾驶员：</td>
                    <td>
                        <input type="text" id="userDefinedCode" style="width: 120px" class=""> </td>
                    <td colspan="4" style="text-align: left;padding-left: 20px;position: relative;">
                        <span class="easyui-linkbutton" data-options="iconCls:'icon-search'" onclick="query('#dg','#searchForm')">查询</span>
                        <span class="easyui-linkbutton" data-options="iconCls:'icon-add'" onclick="addMes('#add','#dg','#w','http://dayan.huayitec.com/driverController/insert')">添加</span>
                        <span class="easyui-linkbutton" data-options="iconCls:'icon-edit'" id="modify" onclick="">修改</span>
                        <span class="easyui-linkbutton" data-options="iconCls:'icon-remove'"  onclick="deleteData()">删除</span>
                    </td>
                </tr>
            </tbody>
        </table>
        <table id="dg" title="" style="width:100%;height:800px;" data-options="onRowContextMenu: onRowContextMenu,rownumbers:true, fitColumns:true,singleSelect:false,pagination:true,url:'../../json/weiguixinxi.json',method:'get'">
            <thead>
                <tr>
                    <th data-options="field:'orgName',width:300,align:'center'">组织机构</th>
                    <th data-options="field:'drvName',width:180,align:'center'">驾驶员姓名</th>
                    <th data-options="field:'cardType',width:200,align:'center'">证件类型</th>
                    <th data-options="field:'cardNum',width:300,align:'center'">证件号码</th>
                    <th data-options="field:'cardDate',width:200,align:'center'">发证日期</th>
                    <th data-options="field:'yearDate',width:200,align:'center'">年检日期</th>
                    <th data-options="field:'endDate',width:200,align:'center'">截止日期</th>
                    <th data-options="field:'maxAge',width:180,align:'center'">有效期</th>
                    <th data-options="field:'cardLev',width:180,align:'center'">证件级别</th>
                    <th data-options="field:'type',width:180,align:'center'">资格类别</th>
                    <th data-options="field:'dangerType',width:180,align:'center'">危化职位</th>
                    <th data-options="field:'allowDrv',width:180,align:'center'">准驾其他</th>
                    <th data-options="field:'cardPic',width:180,align:'center'">证件照片</th>
                    <th data-options="field:'on',width:180,align:'center'">审核状态</th>
                </tr>
            </thead>
        </table>
    </div>
    <script>

        // 修改
        $("#modify").click(function () {
            var row = $('#dg').datagrid('getSelected');
                if (row) {
                    $('#w').window('open')
                } else {
                    $('#w1').window('open')
                } 
            
        })

        // 删除
        function deleteData() {
		  var deletedData = $("#dg").datagrid('getChecked');
		  for (var i = deletedData.length - 1; i >= 0; i--) {
		   var rowIndex = $("#dg").datagrid('getRowIndex', deletedData[i]);
		  if (deletedData.length>0) {  
            	$("#dg").datagrid('deleteRow', rowIndex)
		    }
		  }
}

        function onRowContextMenu(e, rowIndex, rowData) {
            e.preventDefault();
            var selected = $("#dg").datagrid('getRows'); //获取所有行集合对象			
            selected[rowIndex].id; //index为当前右键行的索引，指向当前行对象			
            $('#mm').menu('show', {
                left: e.pageX + 10,
                top: e.pageY
            });
        }
    </script>
</body>

</html>