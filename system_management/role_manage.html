<!DOCTYPE html>
<html>

	<head>
		<meta charset="UTF-8">
		<title></title>
	</head>
	<link rel="stylesheet" type="text/css" href="../css/easyui.css">
	<link rel="stylesheet" type="text/css" href="../css/icon.css">
	<link rel="stylesheet" type="text/css" href="../css/demo.css">
	<link rel="stylesheet" type="text/css" href="../css/index.css">
	<link rel="stylesheet" type="text/css" href="../css/other.css">
	<script type="text/javascript" src="../js/jquery.min.js"></script>
	<script type="text/javascript" src="../js/jquery.easyui.min.js"></script>
	<script type="text/javascript" src="../js/fenye.js"></script>

	<body class="easyui-layout" style="overflow: hidden;">
			<div data-options="region:'center',border:true" style="overflow: hidden;">
				<table border="0" cellspacing="0" cellpadding="0" style="margin: 10px 0 10px 5px;" class="clear_box">
					<tr>
						<td>角色：</td>
						<td><input type="text" /></td>
						<td>角色类型：</td>
						<td>
							<select class="easyui-combobox">
								<option value="">请选择</option>
								<option value="">系统预设</option>
								<option value="">用户创建</option>
							</select>
						</td>
						<td>是否共享：</td>
						<td>
							<select class="easyui-combobox">
								<option value="">请选择</option>
								<option value="">是</option>
								<option value="">否</option>
							</select>
						</td>
						<td>使用单位：</td>
						<td><input id="cc" class="easyui-combotree" data-options="url:'../json/tree_data1.json',method:'get',required:false" style="width:200px;"></td>
						<td style="padding-left: 5px;">
							<span class="easyui-linkbutton" data-options="iconCls:'icon-search'" onclick="refreshbtn('#dg')">查询</span>
							<span class="easyui-linkbutton" data-options="iconCls:'icon-cz_reset'"  onclick="clearSearch('#dg')">重置</span>
							<span class="easyui-linkbutton add" data-options="iconCls:'icon-add'" onclick="alert('#dlg0')">添加</span>
						</td>
					</tr>
				</table>

				<table id="dg" class="easyui-datagrid" title="" style="width:100%;height:600px" data-options="singleSelect:true,collapsible:true,rownumbers:true,pagination:true,pageList:[5,10,15,20],url:'../json/role_manage.json',method:'get'"></table>
		<!--模态框-->
				<div id='dlg0' class="easyui-window" closed='true' title="新增用户" data-options="modal:true,collapsible:false,minimizable:false,maximizable:false,iconCls:'icon-save'" style="width:330px;height:300px;">
					<div style="padding: 10px; box-sizing: border-box;">
					   <table border="0" >
					        <tr>
					       	   <td>角色名：</td>
					       	  <td><input type="text" name="userCode" id="userCode" class="easyui-validatebox" style="width:151px" data-options="required:true"></td>
							</tr>
					        <tr>
					       	   <td>使用单位：</td>
						       <td><input class="easyui-combotree" data-options="url:'../json/tree_data1.json',method:'get',required:true" style="width:155px;"></td>
						    </tr> 
						    <tr>
						      <td>角色描述：</td>
						      <td><textarea rows="6" cols="25"></textarea></td>
						    </tr>					       
					   </table>
					</div>
					<div style="width:100%; text-align: center;margin-top: 10px;">
						<a href="#" class="easyui-linkbutton add_list2" onclick="$('#dlg0').window('close')">确定</a>
						<a href="#" class="easyui-linkbutton" onclick="$('#dlg0').window('close')">关闭</a>
					</div>
				</div>
              
				<div id='dlg' class="easyui-window" closed='true' title="菜单权限" data-options="modal:true,collapsible:false,minimizable:false,maximizable:false,iconCls:'icon-save'" style="width:300px;height:400px;">
					<div class="message" style="padding: 10px; box-sizing: border-box;">
					   <div class="easyui-panel" style="height: 280px;">
							<ul class="easyui-tree" data-options="url:'../json/property.json',method:'get',animate:true,checkbox:true"></ul>
						</div>
					</div>
					<div style="width:100%; text-align: center;margin-top: 10px;">
						<a href="#" class="easyui-linkbutton" onclick="$('#dlg').window('close')">保存</a>
						<a href="#" class="easyui-linkbutton" onclick="$('#dlg').window('close')">关闭</a>
					</div>
				</div>
              
				<div id='dlg1' class="easyui-window" closed='true' title="功能权限" data-options="modal:true,collapsible:false,minimizable:false,maximizable:false,iconCls:'icon-save'" style="width:300px;height:400px;">
					<div class="message" style="padding: 10px; box-sizing: border-box;">
					    <div class="easyui-panel" style="height: 280px;">
							<ul class="easyui-tree" data-options="url:'../json/property.json',method:'get',animate:true,checkbox:true"></ul>
						</div>
					</div>
					<div style="width:100%; text-align: center;margin-top: 10px;">
						<a href="#" class="easyui-linkbutton" onclick="$('#dlg1').window('close')">保存</a>
						<a href="#" class="easyui-linkbutton" onclick="$('#dlg1').window('close')">关闭</a>
					</div>
				</div>
				<div id='dlg2' class="easyui-window" closed='true' title="按钮权限" data-options="modal:true,collapsible:false,minimizable:false,maximizable:false,iconCls:'icon-save'" style="width:300px;height:400px;">
					<div class="message" style="padding: 10px; box-sizing: border-box;">
					     <div class="easyui-panel" style="height: 280px;">
							<ul class="easyui-tree" data-options="url:'../json/property.json',method:'get',animate:true,checkbox:true"></ul>
						</div>
					</div>
					<div style="width:100%; text-align: center;margin-top: 10px;">
						<a href="#" class="easyui-linkbutton" onclick="$('#dlg2').window('close')">保存</a>
						<a href="#" class="easyui-linkbutton" onclick="$('#dlg2').window('close')">关闭</a>
					</div>
				</div>

			</div>

	</body>

	<script type="text/javascript">
		$(function() {
			$('#dg').datagrid({
				idField: 'itemid',
				columns: [
					[{
							field: 'roleName',
							title: '角色',
							width: 200,
							align: 'center',
							sortable: true
						},
						{
							field: 'roleType',
							title: '角色类型',
							width: 200,
							align: 'center',
							sortable: true
						},
						{
							field: 'roleDescription',
							title: '角色描述',
							width: 360,
							align: 'center',
							sortable: true
						},
						{
							field: 'isShare',
							title: '是否共享',
							width: 150,
							align: 'center',
							sortable: true
						},
						{
							field: 'userName',
							title: '创建人',
							width: 220,
							align: 'center',
							sortable: true
						},
						{
							field: 'orgName',
							title: '使用单位',
							width: 240,
							align: 'center',
							sortable: true
						},
						{
							field: 'caozuo',
							title: '操作',
							width: 200,
							align: 'center',
							formatter: function(value, row, index) {
								if(row.editing) {} else {
									var e = '<a href="#" onclick="editrow(this)"  style="color: dodgerblue;margin-right:5px">菜单权限</a>';
									var x = '<a href="#" onclick="saverow(this)"  style="color: dodgerblue;margin-right:5px">功能权限</a>';
									var p = '<a href="#" onclick="cancelrow(this)"  style="color: dodgerblue;">按钮权限</a>';
									return e + x + p;
								}
							}
						}
					]
				]
			});
		});

		function getRowIndex(target) {
			var tr = $(target).closest('tr.datagrid-row');
			return parseInt(tr.attr('datagrid-row-index'));
		}

		function editrow(target) {
			$('#dg').datagrid('beginEdit', getRowIndex(target));
			$('#dlg').window('open');
		}

		function saverow(target) {
			$('#dg').datagrid('endEdit', getRowIndex(target));
			$('#dlg1').window('open');
		}

		function cancelrow(target) {
			$('#dg').datagrid('cancelEdit', getRowIndex(target));
			$('#dlg2').window('open');
		}

		function deleterow(target) {
			$.messager.confirm('Confirm', 'Are you sure?', function(r) {
				if(r) {
					$('#dg').datagrid('deleteRow', getRowIndex(target));
				}
			});
		}
		
//添加一行数据 
	 $('.add_list2').click(function(){
	 	$('#dg').datagrid('insertRow',{
		    index: 11,  // 索引从0开始
		    row: {
		        roleName: '项目监控员',
		        roleType: '1',
		        roleDescription: '二岗合一',
		        isShare: '0',
		        userName: '王红',
		        orgName: '集团公司'
		    }
		});
	 })
	</script>

</html>