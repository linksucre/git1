<!DOCTYPE html>
<html>

	<head>
		<meta charset="UTF-8">
		<title>生产用车申请</title>
	</head>
	<link rel="import" href="../../public.html">
	<script type="text/javascript" src="../../js/loading.js"></script>

	<body>
		<div class="easyui-layout" data-options="fit:true">
			<div data-options="region:'center',border:true" title="生产用车申请">
				<table style="width:90%; height:450px; margin-top: 20px;" border="0">
					<tbody>
						<tr>
							<td align="right">任务名称：</td>
							<td align="left" colspan="4"><input class="easyui-validatebox textbox" data-options="required:true,validType:'length[1,125]'" placeholder="请填入任务名称" type="text" name="taskName" style="width: 100%;"></td>
						</tr>
						<tr>
							<td align="right">用车时间：</td>
							<td align="left" colspan="2">
								<input data-options="required:true" placeholder="请填入用车时间" class="easyui-datetimebox" editable="false" style="width: 140px; display: none;" comboname="useDate">
							</td>
							<td align="right">回车时间：</td>
							<td align="left" colspan="2">
								<input data-options="required:true" placeholder="请填入用车时间" class="easyui-datetimebox" editable="false" style="width: 140px; display: none;" comboname="useDate">
							</td>
						</tr>
						<tr>
							<td align="right" width="10%">装货点：</td>
							<td align="left" width="15%">
								<input class="easyui-validatebox textbox" data-options="required:true" placeholder="请选择装货点" type="text" style="width:100%;" name="leaveAddress">
							</td>
							<td>
								<button class="easyui-linkbutton clear_btn" data-options="iconCls:'icon-add'" onclick="alert('#w1')">列表选择</button>
							
							</td>
	
							<td align="right" width="10%">卸货点：</td>
							<td align="left" width="15%">
								<input class="easyui-validatebox textbox" data-options="required:true" placeholder="请选择卸货点" type="text" name="arriveAddress" style="width:100%;">
							</td>
							<td>
								<button class="easyui-linkbutton clear_btn" data-options="iconCls:'icon-add'" onclick="alert('#w1')">列表选择</button>														
							</td>

						</tr>
						<tr>
							<td align="right">大物流编号：</td>
							<td align="left" colspan="2"><input placeholder="大物流编号" name="deliverId" class="easyui-validatebox textbox" style="width:47%"></td>
							<td align="right">订单编号：</td>
							<td align="left" colspan="2"><input placeholder="请填入订单编号" name="orderId" class="easyui-validatebox textbox" style="width:31%"></td>
						</tr>
						<tr>
							<td align="right">任务类型：</td>
							<td align="left" colspan="2">
								<select class="easyui-combobox" style="width:140px;">
									<option value="0">短期</option>
									<option value="1">长期</option>
								</select>
							</td>
							<td align="right">货车车型：</td>
							<td align="left" colspan="2">
								<select class="easyui-combobox" style="width:140px;">
									<option value="0">普通货车(重型罐式货车)</option>
									<option value="1">普通货车(小型越野货车)</option>
								</select>
							</td>
						</tr>
						<tr>
							<td align="right">用车数量：</td>
							<td align="left" colspan="2">
								<input  value="1" data-options="required:true,validType:'length[1,10]'" style="width:140px; height: 20px; line-height: 20px;">
							</td>
							<td align="right">货物总吨数：</td>
							<td align="left" colspan="2">
								<input style="width:140px; height: 20px; line-height: 20px;" class="easyui-validatebox" data-options="disabled:true" disabled="disabled">T</td>
						</tr>
						<tr>
							<td align="right">货物类型：</td>
							<td colspan="4" align="left">
								<input class="easyui-validatebox textbox" style="width:100%;" data-options="required:true" placeholder="请选择货物" name="goodsName">
							</td>
							<td>
								<button class="easyui-linkbutton clear_btn" data-options="iconCls:'icon-add'" onclick="alert('#w3')">选择货物</button>							
							</td>
											
						</tr>
						<tr>
							<td align="right">单程里程：</td>
							<td align="left" colspan="2">
								<input type="radio" name="isdistance" value="0" checked=""> &lt;400km 
								<input type="radio" name="isdistance" value="1">400-1000km
								<input type="radio" name="isdistance" value="2">&gt;=1000km</td>
							<td align="right">申请优先级：</td>
							<td align="left" colspan="2">
								<select class="easyui-combobox" style="width:140px;">
									<option value="1" selected="">普通</option>
									<option value="2">加急</option>
								</select>
							</td>
						</tr>

						<tr>
							<td align="right">途经点：</td>
							<td align="left" colspan="4">
								<input class="easyui-validatebox" placeholder="请选择途经点" type="text" name="addressText" style="width:100%;">
							</td>
							<td>
								<button class="easyui-linkbutton clear_btn" data-options="required:true,iconCls:'icon-add'" onclick="alert('#w2')">选择途经点</button>
								<button class="easyui-linkbutton clear_btn" data-options="iconCls:'icon-remove'">清空途经点</button>
							</td>
						</tr>
                       <tr>
							<td align="right">说明：</td>
							<td align="left" colspan="4">
								<textarea name="remark" data-options="validType:'length[0,512]'" style="width: 100%; height: 45px; font-size: 13px;" class="easyui-validatebox" placeholder="请输入申请说明"></textarea>
							</td>
						</tr>
						<tr align="center">
							<td colspan="5">
								<button class="easyui-linkbutton" data-options="iconCls:'icon-ok'" >确认</button>
								<button class="easyui-linkbutton" data-options="iconCls:'icon-cz_reset'" onclick="alert('#w4')">重置</button>
							</td>
						</tr>
					</tbody>
				</table>

				<!--模态框-->
				<div id='w1' class="easyui-window" closed='true' title="业务点选择" data-options="modal:true,collapsible:false,minimizable:false,maximizable:false,iconCls:'icon-save'" style="width:1000px;height:500px;">
					<div>
						<table border="0" cellspacing="0" cellpadding="0" class="table_layout clear_box">
							<tr>
								<td>业务点名称：</td>
								<td><input type="text" class="width" /></td>
								<td>城市：</td>
								<td><input type="text" class="width" /></td>
								<td>业务点类型：</td>
								<td colspan="2">
									<select class="easyui-combobox width" name="language">
										<option value="ar">中石油加油(气)站</option>
										<option value="bg">中石化加油(气)站</option>
										<option value="ca">社会加油(气)站</option>
										<option value="zh-cht">油库</option>
										<option value="cs">炼油厂</option>
										<option value="da">运输公司总部</option>
										<option value="nl">省分公司</option>
										<option value="en" selected="selected">配送中心(车队)</option>
										<option value="et">小车队</option>
									</select>
								</td>
								<td>常用业务点：</td>
								<td>
									<select class="easyui-combobox" name="language">
										<option value="ar">全部</option>
										<option value="bg">常用</option>
									</select>
								</td>
								<td colspan="2">
									<span class="easyui-linkbutton" data-options="iconCls:'icon-search'" onclick="refreshbtn('#dg')">查询</span>
									<span class="easyui-linkbutton" data-options="iconCls:'icon-cz_reset'" onclick="clearSearch('#dg')">重置</span>
								</td>
							</tr>
						</table>
						<table id="dg" title="" class="easyui-datagrid" style="width:100%;height:320px" data-options="fitColumns:true,rownumbers:true,singleSelect:false,pagination:true,pageList:[5,10,15,20],url:'../../json/point_select.json',method:'get'">
							<thead>
								<tr>
									<th data-options="field:'checkbox',checkbox:true,width:200"></th>
									<th data-options="field:'businesAddressName',width:200">业务点名称</th>
									<th data-options="field:'addressDetail',width:200">详细地址</th>
									<th data-options="field:'cityName',width:200">城市</th>
									<th data-options="field:'businesAddressType',width:200">业务点类型</th>
								</tr>
							</thead>
						</table>
					</div>
					<div style="width: 100%; text-align: center;">
						<a href="javascript:void(0)" class="easyui-linkbutton" onclick="$('#w1').window('close')">确定</a>
						<a href="javascript:void(0)" class="easyui-linkbutton" onclick="$('#w1').window('close')">关闭</a>
					</div>
				</div>
				<div id='w2' class="easyui-window" closed='true' title="业务点选择" data-options="modal:true,collapsible:false,minimizable:false,maximizable:false,iconCls:'icon-save'" style="width:980px;height:500px;">
					<div>
						<table border="0" cellspacing="0" cellpadding="0" class="clear_box" style="margin-top: 10px;">
							<tr>
								<td>业务点名称：</td>
								<td><input type="text" class="width" /></td>
								<td>城市：</td>
								<td><input type="text" class="width" /></td>
								<td>业务点类型：</td>
								<td colspan="2">
									<select class="easyui-combobox width">
										<option value="ar">中石油加油(气)站</option>
										<option value="bg">中石化加油(气)站</option>
										<option value="ca">社会加油(气)站</option>
										<option value="zh-cht">油库</option>
										<option value="cs">炼油厂</option>
										<option value="da">运输公司总部</option>
										<option value="nl">省分公司</option>
										<option value="en" selected="selected">配送中心(车队)</option>
										<option value="et">小车队</option>
									</select>
								</td>
							</tr>
                            <tr>
                            	<td>常用业务点：</td>
								<td>
									<select class="easyui-combobox" name="language">
										<option value="ar">全部</option>
										<option value="bg">常用</option>
									</select>
								</td>
								<td colspan="2">
									<span class="easyui-linkbutton" data-options="iconCls:'icon-search'" onclick="refreshbtn('#dg2')">查询</span>
									<span class="easyui-linkbutton" data-options="iconCls:'icon-cz_reset'" onclick="clearSearch('#dg2')">重置</span>
								</td>
                            </tr>
						</table>
						<table id="dg2" title="" class="easyui-datagrid" style="width:70%;height:320px" data-options="fitColumns:true,rownumbers:true,singleSelect:false,pagination:true,pageList:[5,10,15,20],url:'../../json/point_select.json',method:'get'">
							<thead>
								<tr>
									<th data-options="field:'checkbox',checkbox:true,width:200"></th>
									<th data-options="field:'businesAddressName',width:200">业务点名称</th>
									<th data-options="field:'addressDetail',width:200">详细地址</th>
									<th data-options="field:'cityName',width:200">城市</th>
									<th data-options="field:'businesAddressType',width:200">业务点类型</th>
								</tr>
							</thead>
						</table>
						<div class="right_box" style="background: #FFFFFF;border: none;margin-top: 26px;">
							<div class="left">
								<span class="lag" onclick="getSelections()">></span>
								<span class="lag de"><</span>
							</div>
							<div class="right"></div>
						</div>
					</div>
					<div class="btn_all">
						<a href="javascript:void(0)" class="easyui-linkbutton" onclick="$('#w2').dialog('close')">确定</a>
						<a href="javascript:void(0)" class="easyui-linkbutton" onclick="$('#w2').dialog('close')">关闭</a>
					</div>
				</div>
				<div id='w3' class="easyui-window" closed='true' title="货物名称" data-options="modal:true,collapsible:false,minimizable:false,maximizable:false,iconCls:'icon-save'" style="width:980px;height:460px;">
					<div>
						<table border="0" cellspacing="0" cellpadding="0" class="table0 clear_box">
							<tr>
								<td>获取名称：</td>
								<td><input type="text" /></td>
								<td colspan="5">
									<span class="easyui-linkbutton" data-options="iconCls:'icon-search'" onclick="refreshbtn('#dg3')">查询</span>
									<span class="easyui-linkbutton" data-options="iconCls:'icon-cz_reset'" onclick="clearSearch('#dg3')">重置</span>
								</td>
							</tr>
						</table>
						<table id="dg3" title="" class="easyui-datagrid" style="width:70%;height:320px" data-options="fitColumns:true,rownumbers:true,singleSelect:false,pagination:true,pageList:[5,10,15,20],url:'../../json/use_car_select.json',method:'get'">
							<thead>
								<tr>
									<th field="checkbox" width="200" checkbox='true'></th>
									<th field="userCode" width="200">用户编号</th>
									<th field="userName" width="200">用户名</th>
									<th field="orgName" width="200">组织机构</th>
									<th field="email" width="200">邮箱</th>
									<th field="phone" width="200">手机号</th>
								</tr>
							</thead>
						</table>
						<div class="right_dlg4" style="top: 78px;">
							<div class="left_dl">
								<span class="lag" onclick="getSelections1()">></span>
								<span class="lag de1"><</span>
							</div>
							<div class="right_dl" style="height: 319px;"></div>
						</div>
					</div>
					<div class="btn_all">
						<a href="javascript:void(0)" class="easyui-linkbutton" onclick="$('#w3').dialog('close')">确定</a>
						<a href="javascript:void(0)" class="easyui-linkbutton" onclick="$('#w3').dialog('close')">关闭</a>
					</div>
				</div>
				<!--重置-->
				<div id='w4' class="easyui-window" closed='true' title="提示信息" data-options="modal:true,collapsible:false,minimizable:false,maximizable:false,iconCls:'icon-save'" style="width:300px;height:130px;">
					<div style="padding:10px;">
						<div class="messager-icon messager-question"></div>
						确认重置所有数据吗？
					</div>
					<div class="btn_all">
						<a href="javascript:void(0)" class="easyui-linkbutton" onclick="$('#w4').dialog('close')">确定</a>
						<a href="javascript:void(0)" class="easyui-linkbutton" onclick="$('#w4').dialog('close')">关闭</a>
					</div>
				</div>
			

			</div>
		</div>
	</body>
	<script type="text/javascript">
		//	选择table中第一个td的内容
		function getSelections() {
			var ids = [];
			var rows = $('#dg2').datagrid('getSelections');
			var getSelect = $('#dg2').datagrid('getData');
			for(var i = 0; i < rows.length; i++) {
				ids.push(rows[i].businesAddressName);
			}
			if(ids.length == getSelect.rows.length) {
				var str1 = ''
				for(var i = 0; i < ids.length; i++) {
					str1 = "<p>" + ids[i] + "</p>";
					$('.right').append(str1);
				}
			} else {
				var str = "<p>" + ids[ids.length - 1] + "</p>";
				$('.right').append(str);
			}
			$('.right p').each(function() {
				$(this).click(function() {
					$(this).css({
						'background': '#1E90FF',
						'color': '#fff',
					});
					$(this).attr('class', 'p');
					$(this).siblings().attr('class', '');
					$(this).siblings().css({
						'background': '#FFF',
						'color': '#000'
					});

				})
			})
		}

		function getSelections1() {
			var ids1 = [];
			var rows1 = $('#dg3').datagrid('getSelections');
			var getSelect1 = $('#dg2').datagrid('getData');
			for(var i = 0; i < rows1.length; i++) {
				ids1.push(rows1[i].userName);
			}
			if(ids1.length == getSelect1.rows.length) {
				var str2 = ''
				for(var i = 0; i < ids1.length; i++) {
					str2 = "<p>" + ids1[i] + "</p>";
					$('.right_dl').append(str2);
				}
			} else {
				var str3 = "<p>" + ids1[ids1.length - 1] + "</p>";
				$('.right_dl').append(str3);
			}
			$('.right_dl p').each(function() {
				$(this).click(function() {
					$(this).css({
						'background': '#1E90FF',
						'color': '#fff',
					});
					$(this).attr('class', 'p1');
					$(this).siblings().attr('class', '');
					$(this).siblings().css({
						'background': '#FFF',
						'color': '#000'
					});

				})
			})
		}
		//	清除div中的内容
		$('.de').click(function() {
			$('.p').remove();
		})
		$('.de1').click(function() {
			$('.p1').remove();
		})
		//  打开弹出框
		function dlg1(dlg) {
			$(dlg).window('open');
		}
		//  更多/收起
		$('.more').click(function() {
			$('.a').show()
			$('.less').show()
			$('.more').hide()
		})
		$('.less').click(function() {
			$('.a').hide()
			$('.more').show()
			$('.less').hide()
		})

		//		function doSearch() {
		//			$('#tt').datagrid('load', {
		//				itemid: $('#itemid').val(),
		//				productid: $('#productid').val()
		//			});
		//		}

		//	  dlg1添加删除
		var editIndex = undefined;

		function endEditing() {
			if(editIndex == undefined) {
				return true
			}
			if($('#dg1').datagrid('validateRow', editIndex)) {
				var ed = $('#dg1').datagrid('getEditor', {
					index: editIndex,
					field: 'productid'
				});
				var productname = $(ed.target).combobox('getText');
				$('#dg1').datagrid('getRows')[editIndex]['productname'] = productname;
				$('#dg1').datagrid('endEdit', editIndex);
				editIndex = undefined;
				return true;
			} else {
				return false;
			}
		}

		function onClickRow(index) {
			if(editIndex != index) {
				if(endEditing()) {
					$('#dg1').datagrid('selectRow', index)
						.datagrid('beginEdit', index);
					editIndex = index;
				} else {
					$('#dg1').datagrid('selectRow', editIndex);
				}
			}
		}

		function append() {
			if(endEditing()) {
				$('#dg1').datagrid('appendRow', {
					status: 'P'
				});
				editIndex = $('#dg1').datagrid('getRows').length - 1;
				$('#dg1').datagrid('selectRow', editIndex)
					.datagrid('beginEdit', editIndex);
			}
		}

		function removeit() {
			if(editIndex == undefined) {
				return
			}
			$('#dg1').datagrid('cancelEdit', editIndex)
				.datagrid('deleteRow', editIndex);
			editIndex = undefined;
		}

		function accept() {
			if(endEditing()) {
				$('#dg1').datagrid('acceptChanges');
			}
		}

		function reject() {
			$('#dg1').datagrid('rejectChanges');
			editIndex = undefined;
		}

		function getChanges() {
			var rows = $('#dg1').datagrid('getChanges');
			alert(rows.length + ' rows are changed!');
		}
		//添加一行数据 
		$('.app_data').click(function() {
			$('#dg1').datagrid('insertRow', {
				index: 11, // 索引从0开始
				row: {
					vehicleTypeName: '客车',
					vehicleType: '3452',

				}
			});
		})
	</script>

</html>